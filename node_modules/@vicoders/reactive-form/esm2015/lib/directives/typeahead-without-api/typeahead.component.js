/**
 * @fileoverview added by tsickle
 * Generated from: lib/directives/typeahead-without-api/typeahead.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, forwardRef, Input, ViewChild } from '@angular/core';
import { SelectionService } from '../selection-by-api/selection-by-api';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { NgbTypeahead } from '@ng-bootstrap/ng-bootstrap';
import { Subject, merge } from 'rxjs';
import { debounceTime, distinctUntilChanged, filter, map } from 'rxjs/operators';
export class TypeaheadWithoutApiComponent {
    constructor() {
        this.states = [];
        this.focus$ = new Subject();
        this.click$ = new Subject();
        this.formatter = (/**
         * @param {?} x
         * @return {?}
         */
        x => x.label);
        this.search = (/**
         * @param {?} text$
         * @return {?}
         */
        (text$) => {
            /** @type {?} */
            const debouncedText$ = text$.pipe(debounceTime(200), distinctUntilChanged());
            /** @type {?} */
            const clicksWithClosedPopup$ = this.click$.pipe(filter((/**
             * @return {?}
             */
            () => !this.instance.isPopupOpen())));
            /** @type {?} */
            const inputFocus$ = this.focus$;
            return merge(debouncedText$, inputFocus$, clicksWithClosedPopup$).pipe(
            // tslint:disable-next-line:max-line-length
            map((/**
             * @param {?} term
             * @return {?}
             */
            term => (term === '' ? this.states : this.states.filter((/**
             * @param {?} v
             * @return {?}
             */
            v => v.label.toLowerCase().indexOf(term.toLowerCase()) > -1))).slice(0, 10))));
            // tslint:disable-next-line:semicolon
        });
        this.propagateChange = (/**
         * @param {?} val
         * @return {?}
         */
        (val) => { });
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @return {?}
     */
    ngOnChanges() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            if (this.isClear) {
                this.value = null;
                this.model = this.value;
            }
        }), 1);
    }
    /**
     * @param {?} data
     * @return {?}
     */
    filterData(data) {
        if (typeof data === 'object') {
            this.value = data;
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.states = this.options;
            if (this.value) {
                this.model = this.value;
            }
        }), 1);
    }
    /**
     * @return {?}
     */
    get value() {
        return this._value;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set value(val) {
        this._value = val;
        this.propagateChange(this._value);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    writeValue(value) {
        if (value !== undefined) {
            this.value = value;
        }
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.propagateChange = fn;
    }
    /**
     * @return {?}
     */
    registerOnTouched() { }
}
TypeaheadWithoutApiComponent.decorators = [
    { type: Component, args: [{
                // tslint:disable-next-line:component-selector
                selector: 'typeahead-without-api',
                template: "<div>\n  <ng-template #rt let-r=\"result\" let-t=\"term\">\n    <ngb-highlight [result]=\"r.label\" [term]=\"t\"></ngb-highlight>\n  </ng-template>\n  <input\n    [resultTemplate]=\"rt\"\n    [inputFormatter]=\"formatter\"\n    id=\"typeahead-focus-{{ id }}\"\n    type=\"text\"\n    class=\"form-control\"\n    [(ngModel)]=\"model\"\n    [ngbTypeahead]=\"search\"\n    (focus)=\"focus$.next($event.target.value)\"\n    (click)=\"click$.next($event.target.value)\"\n    #instance=\"ngbTypeahead\"\n    (ngModelChange)=\"filterData(model)\"\n  />\n</div>\n",
                providers: [
                    {
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => TypeaheadWithoutApiComponent)),
                        multi: true
                    },
                    SelectionService
                ],
                styles: ["ngb-highlight{position:relative;margin-right:15px}ngb-highlight:after{position:absolute;content:'-';top:0;right:-10px}ngb-highlight:last-child:after{position:absolute;content:''}"]
            }] }
];
/** @nocollapse */
TypeaheadWithoutApiComponent.ctorParameters = () => [];
TypeaheadWithoutApiComponent.propDecorators = {
    _value: [{ type: Input }],
    id: [{ type: Input }],
    options: [{ type: Input }],
    isClear: [{ type: Input }],
    instance: [{ type: ViewChild, args: ['instance', {},] }]
};
if (false) {
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype._value;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.id;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.options;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.isClear;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.states;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.model;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.instance;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.focus$;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.click$;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.formatter;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.search;
    /** @type {?} */
    TypeaheadWithoutApiComponent.prototype.propagateChange;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZWFoZWFkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B2aWNvZGVycy9yZWFjdGl2ZS1mb3JtLyIsInNvdXJjZXMiOlsibGliL2RpcmVjdGl2ZXMvdHlwZWFoZWFkLXdpdGhvdXQtYXBpL3R5cGVhaGVhZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFVBQVUsRUFBRSxLQUFLLEVBQWlCLFNBQVMsRUFBYSxNQUFNLGVBQWUsQ0FBQztBQUMxRyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUN4RSxPQUFPLEVBQUUsaUJBQWlCLEVBQXdCLE1BQU0sZ0JBQWdCLENBQUM7QUFDekUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQzFELE9BQU8sRUFBRSxPQUFPLEVBQWMsS0FBSyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2xELE9BQU8sRUFBRSxZQUFZLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBZ0JqRixNQUFNLE9BQU8sNEJBQTRCO0lBaUN2QztRQTFCQSxXQUFNLEdBQVEsRUFBRSxDQUFDO1FBS2pCLFdBQU0sR0FBRyxJQUFJLE9BQU8sRUFBVSxDQUFDO1FBQy9CLFdBQU0sR0FBRyxJQUFJLE9BQU8sRUFBVSxDQUFDO1FBQy9CLGNBQVM7Ozs7UUFBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUM7UUFFekIsV0FBTTs7OztRQUFHLENBQUMsS0FBeUIsRUFBRSxFQUFFOztrQkFDL0IsY0FBYyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQy9CLFlBQVksQ0FBQyxHQUFHLENBQUMsRUFDakIsb0JBQW9CLEVBQUUsQ0FDdkI7O2tCQUNLLHNCQUFzQixHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU07OztZQUFDLEdBQUcs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Z0I7O0lBQ2hCLDBDQUFZOztJQUNaLCtDQUFpQjs7SUFDakIsK0NBQ2lCOztJQUVqQiw4Q0FBaUI7O0lBRWpCLDZDQUFXOztJQUVYLGdEQUFrRDs7SUFDbEQsOENBQStCOztJQUMvQiw4Q0FBK0I7O0lBQy9CLGlEQUF5Qjs7SUFFekIsOENBZUU7O0lBR0YsdURBQW1DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIGZvcndhcmRSZWYsIElucHV0LCBBZnRlclZpZXdJbml0LCBWaWV3Q2hpbGQsIE9uQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU2VsZWN0aW9uU2VydmljZSB9IGZyb20gJy4uL3NlbGVjdGlvbi1ieS1hcGkvc2VsZWN0aW9uLWJ5LWFwaSc7XG5pbXBvcnQgeyBOR19WQUxVRV9BQ0NFU1NPUiwgQ29udHJvbFZhbHVlQWNjZXNzb3IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBOZ2JUeXBlYWhlYWQgfSBmcm9tICdAbmctYm9vdHN0cmFwL25nLWJvb3RzdHJhcCc7XG5pbXBvcnQgeyBTdWJqZWN0LCBPYnNlcnZhYmxlLCBtZXJnZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZGVib3VuY2VUaW1lLCBkaXN0aW5jdFVudGlsQ2hhbmdlZCwgZmlsdGVyLCBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbkBDb21wb25lbnQoe1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gIHNlbGVjdG9yOiAndHlwZWFoZWFkLXdpdGhvdXQtYXBpJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3R5cGVhaGVhZC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3R5cGVhaGVhZC5jb21wb25lbnQuY3NzJ10sXG4gIHByb3ZpZGVyczogW1xuICAgIHtcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gVHlwZWFoZWFkV2l0aG91dEFwaUNvbXBvbmVudCksXG4gICAgICBtdWx0aTogdHJ1ZVxuICAgIH0sXG4gICAgU2VsZWN0aW9uU2VydmljZVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIFR5cGVhaGVhZFdpdGhvdXRBcGlDb21wb25lbnQgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciwgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMge1xuICBASW5wdXQoKSBfdmFsdWU7XG4gIEBJbnB1dCgpIGlkO1xuICBASW5wdXQoKSBvcHRpb25zO1xuICBASW5wdXQoKVxuICBpc0NsZWFyOiBCb29sZWFuO1xuXG4gIHN0YXRlczogYW55ID0gW107XG5cbiAgbW9kZWw6IGFueTtcblxuICBAVmlld0NoaWxkKCdpbnN0YW5jZScsIHt9KSBpbnN0YW5jZTogTmdiVHlwZWFoZWFkO1xuICBmb2N1cyQgPSBuZXcgU3ViamVjdDxzdHJpbmc+KCk7XG4gIGNsaWNrJCA9IG5ldyBTdWJqZWN0PHN0cmluZz4oKTtcbiAgZm9ybWF0dGVyID0geCA9PiB4LmxhYmVsO1xuXG4gIHNlYXJjaCA9ICh0ZXh0JDogT2JzZXJ2YWJsZTxzdHJpbmc+KSA9PiB7XG4gICAgY29uc3QgZGVib3VuY2VkVGV4dCQgPSB0ZXh0JC5waXBlKFxuICAgICAgZGVib3VuY2VUaW1lKDIwMCksXG4gICAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZCgpXG4gICAgKTtcbiAgICBjb25zdCBjbGlja3NXaXRoQ2xvc2VkUG9wdXAkID0gdGhpcy5jbGljayQucGlwZShmaWx0ZXIoKCkgPT4gIXRoaXMuaW5zdGFuY2UuaXNQb3B1cE9wZW4oKSkpO1xuICAgIGNvbnN0IGlucHV0Rm9jdXMkID0gdGhpcy5mb2N1cyQ7XG5cbiAgICByZXR1cm4gbWVyZ2UoZGVib3VuY2VkVGV4dCQsIGlucHV0Rm9jdXMkLCBjbGlja3NXaXRoQ2xvc2VkUG9wdXAkKS5waXBlKFxuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuICAgICAgbWFwKHRlcm0gPT5cbiAgICAgICAgKHRlcm0gPT09ICcnID8gdGhpcy5zdGF0ZXMgOiB0aGlzLnN0YXRlcy5maWx0ZXIodiA9PiB2LmxhYmVsLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0ZXJtLnRvTG93ZXJDYXNlKCkpID4gLTEpKS5zbGljZSgwLCAxMClcbiAgICAgIClcbiAgICApO1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpzZW1pY29sb25cbiAgfTtcblxuICBjb25zdHJ1Y3RvcigpIHt9XG4gIHByb3BhZ2F0ZUNoYW5nZSA9ICh2YWw6IGFueSkgPT4ge307XG5cbiAgbmdPbkluaXQoKSB7fVxuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaXNDbGVhcikge1xuICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcbiAgICAgICAgdGhpcy5tb2RlbCA9IHRoaXMudmFsdWU7XG4gICAgICB9XG4gICAgfSwgMSk7XG4gIH1cblxuXG4gIGZpbHRlckRhdGEoZGF0YSkge1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHRoaXMudmFsdWUgPSBkYXRhO1xuICAgIH1cbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuc3RhdGVzID0gdGhpcy5vcHRpb25zO1xuICAgICAgaWYgKHRoaXMudmFsdWUpIHtcbiAgICAgICAgdGhpcy5tb2RlbCA9IHRoaXMudmFsdWU7XG4gICAgICB9XG4gICAgfSwgMSk7XG4gIH1cblxuICBnZXQgdmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICB9XG5cbiAgc2V0IHZhbHVlKHZhbCkge1xuICAgIHRoaXMuX3ZhbHVlID0gdmFsO1xuICAgIHRoaXMucHJvcGFnYXRlQ2hhbmdlKHRoaXMuX3ZhbHVlKTtcbiAgfVxuXG4gIHdyaXRlVmFsdWUodmFsdWU6IGFueSkge1xuICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJPbkNoYW5nZShmbikge1xuICAgIHRoaXMucHJvcGFnYXRlQ2hhbmdlID0gZm47XG4gIH1cblxuICByZWdpc3Rlck9uVG91Y2hlZCgpIHt9XG59XG5cbi8vIGh0dHBzOi8vbmctYm9vdHN0cmFwLmdpdGh1Yi5pby8jL2NvbXBvbmVudHMvdHlwZWFoZWFkL2V4YW1wbGVzXG4iXX0=