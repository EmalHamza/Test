/**
 * @fileoverview added by tsickle
 * Generated from: lib/directives/upload-file/upload-images.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as _ from 'lodash';
import { FileService } from './test';
import { Component, Input, forwardRef, ElementRef, Injector } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { HttpClient } from '@angular/common/http';
import { NgProgress } from '@ngx-progressbar/core';
export class UploadFilesComponent {
    /**
     * @param {?} injector
     * @param {?} api
     * @param {?} element
     * @param {?} http
     * @param {?} progress
     */
    constructor(injector, api, element, http, progress) {
        this.injector = injector;
        this.api = api;
        this.element = element;
        this.http = http;
        this.progress = progress;
        this.inProgress = {
            process: false,
            error: false
        };
        this.number_file_upload_success = 0;
        this.fileList = [];
        this.isload = false;
        this.isShowDetail = false;
        this.imageFormats = ['jpg', 'jpeg', 'png', 'gif', 'djvu', 'raw', 'ico', 'svg', 'tiff', 'bmp'];
        this.documentFormats = ['pdf', 'doc', 'docx', 'xls', 'xlsx', 'txt', 'rtf', 'odt', 'ppt', 'pptx', 'csv', 'xml'];
        this.videoFormats = ['3gp', 'asf', 'avi', 'mov', 'mp4', 'rm', 'vob', 'wmv'];
        this.soundFormats = ['mp3', 'wma', 'wav', 'flac', 'aac', 'ogg', 'aiff', 'alac'];
        this.preventAbuse = false;
        this.getImageDimension = (/**
         * @param {?} imgUrl
         * @return {?}
         */
        (imgUrl) => {
            /** @type {?} */
            let check = true;
            /** @type {?} */
            const img = new Image();
            img.src = imgUrl;
            img.onload = (/**
             * @param {?} event
             * @return {?}
             */
            (event) => {
                /** @type {?} */
                const loadedImage = event.currentTarget;
                /** @type {?} */
                const width = loadedImage.width;
                /** @type {?} */
                const height = loadedImage.height;
                if (!_.isNil(this.width)) {
                    if (width !== this.width) {
                        check = false;
                        this.errorMessage = `*Image width should be equal to ${this.width}px`;
                    }
                }
                if (!_.isNil(this.maxWidth)) {
                    if (width > this.maxWidth) {
                        check = false;
                        this.errorMessage = `*Image width should be smaller ${this.maxWidth}px`;
                    }
                }
                if (!_.isNil(this.height)) {
                    if (height !== this.height) {
                        check = false;
                        this.errorMessage = `*Image height should be equal to ${this.height}px`;
                    }
                }
                if (!_.isNil(this.maxHeight)) {
                    if (height > this.maxHeight) {
                        check = false;
                        this.errorMessage = `*Image height should be smaller ${this.maxHeight}px`;
                    }
                }
                if (!check) {
                    this.warning = null;
                }
            });
        });
        this.onChange = (/**
         * @param {?} val
         * @return {?}
         */
        (val) => { });
        this.onTouched = (/**
         * @return {?}
         */
        () => { });
        this.disabled = false;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    writeValue(val) {
        if (val) {
            this.value = val;
        }
    }
    /**
     * @return {?}
     */
    get value() {
        return this._value;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set value(val) {
        this._value = val;
        this.onChange(this._value);
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.progressRef = this.progress.ref('progress-bar-' + this.id);
            this.actionRender();
        }), 1);
    }
    /**
     * @param {?} id
     * @return {?}
     */
    uploadFile(id) {
        /** @type {?} */
        const $this = this;
        if (this.inProgress['process'] !== true) {
            /** @type {?} */
            const input = document.createElement('input');
            input.type = 'file';
            if (!_.isNil(this.multiple) && this.multiple === true) {
                input.multiple = true;
            }
            $(input).trigger('click');
            $(input).on('change', (/**
             * @param {?} event
             * @return {?}
             */
            event => {
                this.number_file_upload_success = 0;
                this.files = input.files;
                if (this.files.length > 1) {
                    this.response_data = [];
                    _.forEach(this.files, (/**
                     * @param {?} file
                     * @return {?}
                     */
                    function (file) {
                        $this.validateFile(file);
                    }));
                }
                if (this.files.length === 1) {
                    this.validateFile(this.files[0]);
                }
            }));
        }
    }
    /**
     * @return {?}
     */
    ngOnChanges() {
        if (this.isClear === true) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                if (!_.isNil(this.multiple) && this.multiple === true) {
                    this.oldValue = [];
                    this.fileList = [];
                }
                else {
                    this.oldValue = null;
                }
                /** @type {?} */
                const $this = this;
                if (!_.isNil(this.multiple) && this.multiple === true && !_.isEmpty($this.oldValue)) {
                    _.forEach(this.oldValue, (/**
                     * @param {?} value
                     * @return {?}
                     */
                    function (value) {
                        $this.fileList.push(value);
                        $this.value = $this.fileList;
                    }));
                }
                else {
                    $this.value = $this.oldValue;
                }
            }), 1);
        }
    }
    /**
     * @return {?}
     */
    actionRender() {
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        let $this = this;
        this.isload = true;
        if (!_.isNil(this.multiple) && this.multiple === true && !_.isEmpty($this.oldValue)) {
            _.forEach(this.oldValue, (/**
             * @param {?} value
             * @return {?}
             */
            function (value) {
                $this.fileList.push(value);
                $this.value = $this.fileList;
            }));
        }
        else {
            $this.value = $this.oldValue;
        }
        this.isload = false;
        if (!_.isUndefined(this.accept)) {
            this.valid_extensions = this.accept.split('|');
        }
        // $('#uploadfile_v2-reactive-form-' + this.id).click(() => {
        //   console.log(this.inProgress);
        //   if (this.inProgress['process'] !== true) {
        //     const input = document.createElement('input');
        //     input.type = 'file';
        //     if (!_.isNil(this.multiple) && this.multiple === true) {
        //       input.multiple = true;
        //     }
        //     $(input).trigger('click');
        //     $(input).on('change', event => {
        //       this.number_file_upload_success = 0;
        //       this.files = input.files;
        //       if (this.files.length > 1) {
        //         this.response_data = [];
        //         _.forEach(this.files, function(file) {
        //           $this.validateFile(file);
        //         });
        //       }
        //       if (this.files.length === 1) {
        //         this.validateFile(this.files[0]);
        //       }
        //     });
        //   }
        // });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (!_.isNil(this.maxWidth)) {
            this.warning = `*The image width should be smaller ${this.maxWidth}`;
        }
        if (!_.isNil(this.maxHeight)) {
            this.warning = `*The image width should be smaller ${this.maxHeight}`;
        }
        if (!_.isNil(this.width) && !_.isNil(this.height)) {
            this.warning = `*Recommended size: ${this.width}x${this.height}`;
        }
        else {
            if (!_.isNil(this.width)) {
                this.warning = `*Recommended width: ${this.width}`;
            }
            if (!_.isNil(this.height)) {
                this.warning = `*Recommended height: ${this.height}`;
            }
        }
    }
    /**
     * @param {?} file
     * @return {?}
     */
    getFileExtension(file) {
        return file.name.split('.').pop();
    }
    /**
     * @param {?} file
     * @return {?}
     */
    validateFile(file) {
        if (file !== undefined) {
            if (!_.isNil(this.allowMaxSize) && this.allowMaxSize !== '') {
                if (file.size > parseFloat(this.allowMaxSize) * 1024 * 1024) {
                    this.errorMessage = `Please select file less than ${this.allowMaxSize}MB`;
                    return false;
                }
            }
            // tslint:disable-next-line:max-line-length
            if (!_.isUndefined(this.accept) &&
                _.isUndefined(_.find(this.valid_extensions, (/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.toLowerCase() === this.getFileExtension(file).toLowerCase())))) {
                this.errorMessage = 'Please select a file with valid type';
                return false;
            }
            this.upload(file);
        }
    }
    /**
     * @param {?} file
     * @return {?}
     */
    upload(file) {
        this.preventAbuse = true;
        this.progressRef.start();
        /** @type {?} */
        const UPLOAD_DIRECTIVE_HEADERS = this.injector.get('UPLOAD_DIRECTIVE_HEADERS');
        /** @type {?} */
        const UPLOAD_DIRECTIVE_API_URL = this.injector.get('UPLOAD_DIRECTIVE_API_URL');
        this.isload = true;
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        let $this = this;
        this.inProgress['process'] = true;
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        let params = {
            // files: file
            upload_path: this.uploadPath
        };
        params[this.paramName] = file;
        /** @type {?} */
        const requestHeaders = UPLOAD_DIRECTIVE_HEADERS;
        /** @type {?} */
        const requestApiUrl = UPLOAD_DIRECTIVE_API_URL + this.apiUpload;
        this.api.upload(params, requestApiUrl, requestHeaders).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        response => {
            // setTimeout(() => {
            this.progressRef.complete();
            this.inProgress['process'] = false;
            this.number_file_upload_success++;
            if (!_.isNil($this.multiple) && $this.multiple === true) {
                $this.fileList.push($this.resultTransformer(response));
                $this.value = $this.fileList;
            }
            else {
                $this.value = $this.resultTransformer(response);
                if (response) {
                    if (!_.isNil($this.width) || !_.isNil($this.height) || !_.isNil($this.maxWidth) || !_.isNil($this.maxHeight)) {
                        $this.getImageDimension(response.data[0].full_path);
                    }
                }
            }
            this.isload = false;
            this.errorMessage = null;
            this.preventAbuse = false;
            // }, 800);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            this.isload = false;
            this.inProgress['process'] = false;
            console.log('error', error);
            this.errorMessage = error.message;
            this.progressRef.complete();
        }));
    }
    /**
     * @param {?} item
     * @return {?}
     */
    deleteItem(item) {
        if (this.multiple === true) {
            this.fileList.splice(this.fileList.indexOf(item), 1);
            this.value = this.fileList;
        }
        else {
            this.value = null;
        }
    }
    /**
     * @param {?} value
     * @param {?} arr
     * @return {?}
     */
    isInclude(value, arr) {
        /** @type {?} */
        const accepts = value.split('|');
        /** @type {?} */
        let result = true;
        _.forEach(accepts, (/**
         * @param {?} i
         * @return {?}
         */
        function (i) {
            if (!_.find(arr, (/**
             * @param {?} item
             * @return {?}
             */
            item => item === i))) {
                result = false;
            }
        }));
        return result;
    }
    /**
     * @param {?} accepts
     * @return {?}
     */
    getIcon(accepts) {
        /** @type {?} */
        const $this = this;
        accepts = accepts.split('|');
        /** @type {?} */
        let result = 'fa-exclamation-triangle';
        _.forEach(accepts, (/**
         * @param {?} i
         * @return {?}
         */
        function (i) {
            if (_.find($this.documentFormats, (/**
             * @param {?} item
             * @return {?}
             */
            item => item === i))) {
                result = 'fa-file-text-o';
            }
            if (_.find($this.videoFormats, (/**
             * @param {?} item
             * @return {?}
             */
            item => item === i))) {
                result = 'fa-file-video-o';
            }
            if (_.find($this.soundFormats, (/**
             * @param {?} item
             * @return {?}
             */
            item => item === i))) {
                result = 'fa-file-audio-o';
            }
        }));
        return result;
    }
    /**
     * @return {?}
     */
    okok() {
        this.dataFunction();
    }
}
UploadFilesComponent.decorators = [
    { type: Component, args: [{
                // tslint:disable-next-line:component-selector
                selector: 'upload-file',
                template: "<div class=\"row\" *ngIf=\"isInclude(accept, imageFormats)\">\n  <div class=\"col-md-12 form-wrapper\" style=\"margin-bottom: 15px;\">\n    <div class=\"signle-img zoom-effect-container\" *ngIf=\"!multiple || multiple === false\">\n      <div class=\"rf__ulf_preview_content image-card\">\n        <a *ngIf=\"value\" href=\"{{ value }}\" target=\"_blank\">\n          <img\n            [ngStyle]=\"{\n              'background-image': 'url(' + value + ')',\n              'background-position': 'center',\n              'background-repeat': 'no-repeat',\n              'background-size': 'cover'\n            }\"\n            src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlEMjQ4QkVCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTlEMjQ4Q0VCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5OUQyNDg5RUJCRTExRThCRDY3OURGRUFDRDA0RTREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY5OUQyNDhBRUJCRTExRThCRDY3OURGRUFDRDA0RTREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+O7rz2AAAASBJREFUeNrs0jERAAAIxDDAv+fHACNjIqHXTlLwbSTAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsuK0AAwBL0gQp9PLLgwAAAABJRU5ErkJggg==\"\n            width=\"100\"\n            alt=\"\"\n          />\n          <i title=\"remove\" (click)=\"deleteItem(value); (false)\" class=\"fa fa-trash-o rf__remove\" aria-hidden=\"true\"></i>\n        </a>\n      </div>\n      <p *ngIf=\"warning\" class=\"warning\">{{ warning }}</p>\n      <ng-progress color=\"#92c34e\" id=\"progress-bar-{{ id }}\" fixed=\"false\" spinnerPosition=\"left\"></ng-progress>\n      <button\n        (click)=\"uploadFile(id)\"\n        [ngClass]=\"{ waitting: preventAbuse }\"\n        type=\"button\"\n        *ngIf=\"multiple === false || !multiple\"\n        id=\"uploadfile_v2-reactive-form-{{ id }}\"\n        class=\"chip\"\n        [disabled]=\"preventAbuse\"\n      >\n        <span [innerHTML]=\"preventAbuse ? 'Wait...' : (title | noSanitize)\"></span>\n      </button>\n      <button type=\"button\" class=\"chip\" *ngIf=\"uploadFromDB\" (click)=\"okok()\">Choose</button>\n    </div>\n    <div class=\"rf__ulf_content\" *ngIf=\"multiple === true\">\n      <div class=\"mutil-img\">\n        <ng-progress color=\"#92c34e\" id=\"progress-bar-{{ id }}\" fixed=\"false\" spinnerPosition=\"left\"></ng-progress>\n        <div class=\"group-item zoom-effect-container-multi\" *ngFor=\"let item of value\">\n          <div class=\"image-card\">\n            <a href=\"{{ item }}\" target=\"_blank\">\n              <img\n                [ngStyle]=\"{\n                  'background-image': 'url(' + item + ')',\n                  'background-position': 'center',\n                  'background-repeat': 'no-repeat',\n                  'background-size': 'cover'\n                }\"\n                class=\"singleImg\"\n                alt=\"\"\n                src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlEMjQ4QkVCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTlEMjQ4Q0VCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5OUQyNDg5RUJCRTExRThCRDY3OURGRUFDRDA0RTREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY5OUQyNDhBRUJCRTExRThCRDY3OURGRUFDRDA0RTREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+O7rz2AAAASBJREFUeNrs0jERAAAIxDDAv+fHACNjIqHXTlLwbSTAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsuK0AAwBL0gQp9PLLgwAAAABJRU5ErkJggg==\"\n              />\n            </a>\n          </div>\n\n          <span title=\"Remove\" (click)=\"deleteItem(item)\"><i class=\"fa fa-trash-o\" aria-hidden=\"true\"></i></span>\n        </div>\n      </div>\n      <button\n        (click)=\"uploadFile(id)\"\n        [ngClass]=\"{ waitting: preventAbuse }\"\n        type=\"button\"\n        *ngIf=\"multiple === true\"\n        id=\"uploadfile_v2-reactive-form-{{ id }}\"\n        class=\"chip\"\n        [disabled]=\"preventAbuse\"\n      >\n        <span [innerHTML]=\"preventAbuse ? 'Wait...' : (title | noSanitize)\"></span>\n      </button>\n      <button type=\"button\" class=\"chip\" *ngIf=\"uploadFromDB\" (click)=\"okok()\">Choose</button>\n      <!-- <div class=\"loader-img add-icon\" *ngIf=\"isload\"></div>\n      <div id=\"uploadfile_v2-reactive-form-{{ id }}\" class=\"plus icon add-icon\"></div> -->\n    </div>\n  </div>\n</div>\n\n<div class=\"row\" *ngIf=\"!isInclude(accept, imageFormats)\">\n  <div class=\"col-md-12\" style=\"margin-bottom: 15px;\">\n    <div class=\"rf_uld_preview\" *ngIf=\"!multiple || multiple === false\">\n      <div class=\"form-group\" *ngIf=\"value\">\n        <p>\n          <i class=\"fa {{ getIcon(accept) }}\" aria-hidden=\"true\"></i> {{ value }}\n          <i (click)=\"deleteItem(value); (false)\" class=\"fa fa-trash-o\" aria-hidden=\"true\"></i>\n        </p>\n      </div>\n      <ng-progress color=\"#92c34e\" id=\"progress-bar-{{ id }}\" fixed=\"false\" spinnerPosition=\"left\"></ng-progress>\n    </div>\n    <div class=\"mutil-img rf_uld_preview  rf_uld_preview-multil\" *ngIf=\"multiple === true\">\n      <ng-progress color=\"#92c34e\" id=\"progress-bar-{{ id }}\" fixed=\"false\" spinnerPosition=\"left\"></ng-progress>\n      <div class=\"form-group\" *ngFor=\"let item of value\">\n        <p>\n          <i class=\"fa {{ getIcon(accept) }}\" aria-hidden=\"true\"></i> {{ item\n          }}<i (click)=\"deleteItem(item)\" class=\"fa fa-trash-o\" aria-hidden=\"true\"></i>\n        </p>\n      </div>\n    </div>\n    <div class=\"form-group\">\n      <button\n        (click)=\"uploadFile(id)\"\n        [ngClass]=\"{ waitting: preventAbuse }\"\n        type=\"button\"\n        id=\"uploadfile_v2-reactive-form-{{ id }}\"\n        class=\"chip\"\n        [disabled]=\"preventAbuse\"\n      >\n        <span [innerHTML]=\"preventAbuse ? 'Wait...' : (title | noSanitize)\"></span>\n      </button>\n    </div>\n  </div>\n</div>\n\n<div *ngIf=\"errorMessage\" class=\"error-message\">{{ errorMessage }}</div>\n",
                providers: [
                    FileService,
                    {
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => UploadFilesComponent)),
                        multi: true
                    }
                ],
                styles: [".form-wrapper{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}img{cursor:pointer}.chip{box-sizing:border-box;margin:15px 0 1em;border-radius:1.5em;padding:.6em 1em;font-size:.8em;width:136px;text-align:center;border:none;background-color:#92c34e;color:#fff;cursor:pointer}ng-progress{position:absolute;top:0;left:0;right:0}.error-message{color:red}.btn-upload-file{position:relative}.btn-upload-file .add-icon{position:absolute;right:-50px;top:0}.fa-times{margin-left:15px;cursor:pointer;color:#cd5c5c}.waitting{background:#ecf0f1}.form-wrapper .signle-img{text-align:center;position:relative;overflow:hidden;width:150px}.form-wrapper .signle-img .rf__ulf_preview_content{width:150xp;min-height:150px;background-color:#ecf0f1}.form-wrapper .signle-img img{width:100%}.form-wrapper .signle-img .rf__ulf_preview_content a .rf__remove{position:absolute;top:5px;right:5px}.rf__ulf_content{width:100%}.mutil-img .group-item{display:inline-block;position:relative;margin-right:10px;margin-bottom:30px}.mutil-img .group-item span{position:absolute;left:50%;bottom:-25px;margin-left:-25px;cursor:pointer;font-size:14px}.mutil-img .group-item span:hover{text-decoration:underline;color:grey}.form-wrapper .mutil-img{display:-webkit-box;display:flex;flex-wrap:wrap;-webkit-box-align:center;align-items:center;width:100%;min-height:200px;background-color:#d3d3d3;padding:10px;position:relative;overflow:hidden;-webkit-transition:.4s;transition:.4s}.form-wrapper .mutil-img img{width:100%;border-radius:10px}.image-card img{-webkit-transition:.4s;transition:.4s}.zoom-effect-container-multi:hover .image-card img,.zoom-effect-container:hover .image-card img{-webkit-transform:scale(1.08);transform:scale(1.08)}.zoom-effect-container-multi .image-card img{-webkit-transition:.4s;transition:.4s}.rf_uld_preview{width:100%;min-height:50px;background-color:#ecf0f1;padding:10px;position:relative;overflow:hidden}.rf_uld_preview .fa-file-text-o,.rf_uld_preview .form-group,.rf_uld_preview .form-group p{margin:0}.rf_uld_preview .form-group p{border-radius:10px;padding:5px 10px;background-color:#bdc3c7;font-size:14px}.rf_uld_preview-multil .form-group p{margin-bottom:10px}.warning{color:gray;margin-bottom:10px;margin-top:10px;font-size:11px}"]
            }] }
];
/** @nocollapse */
UploadFilesComponent.ctorParameters = () => [
    { type: Injector },
    { type: FileService },
    { type: ElementRef },
    { type: HttpClient },
    { type: NgProgress }
];
UploadFilesComponent.propDecorators = {
    id: [{ type: Input }],
    headers: [{ type: Input }],
    apiUpload: [{ type: Input }],
    accept: [{ type: Input }],
    allowMaxSize: [{ type: Input }],
    uploadPath: [{ type: Input }],
    multiple: [{ type: Input }],
    _value: [{ type: Input }],
    resultTransformer: [{ type: Input }],
    paramName: [{ type: Input }],
    oldValue: [{ type: Input }],
    isClear: [{ type: Input }],
    title: [{ type: Input }],
    dataFunction: [{ type: Input }],
    uploadFromDB: [{ type: Input }],
    width: [{ type: Input }],
    maxWidth: [{ type: Input }],
    height: [{ type: Input }],
    maxHeight: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    UploadFilesComponent.prototype.id;
    /** @type {?} */
    UploadFilesComponent.prototype.headers;
    /** @type {?} */
    UploadFilesComponent.prototype.apiUpload;
    /** @type {?} */
    UploadFilesComponent.prototype.accept;
    /** @type {?} */
    UploadFilesComponent.prototype.allowMaxSize;
    /** @type {?} */
    UploadFilesComponent.prototype.uploadPath;
    /** @type {?} */
    UploadFilesComponent.prototype.multiple;
    /** @type {?} */
    UploadFilesComponent.prototype._value;
    /** @type {?} */
    UploadFilesComponent.prototype.resultTransformer;
    /** @type {?} */
    UploadFilesComponent.prototype.paramName;
    /** @type {?} */
    UploadFilesComponent.prototype.oldValue;
    /** @type {?} */
    UploadFilesComponent.prototype.isClear;
    /** @type {?} */
    UploadFilesComponent.prototype.title;
    /** @type {?} */
    UploadFilesComponent.prototype.dataFunction;
    /** @type {?} */
    UploadFilesComponent.prototype.uploadFromDB;
    /** @type {?} */
    UploadFilesComponent.prototype.width;
    /** @type {?} */
    UploadFilesComponent.prototype.maxWidth;
    /** @type {?} */
    UploadFilesComponent.prototype.height;
    /** @type {?} */
    UploadFilesComponent.prototype.maxHeight;
    /** @type {?} */
    UploadFilesComponent.prototype.inProgress;
    /** @type {?} */
    UploadFilesComponent.prototype.files;
    /** @type {?} */
    UploadFilesComponent.prototype.number_file_upload_success;
    /** @type {?} */
    UploadFilesComponent.prototype.response_data;
    /** @type {?} */
    UploadFilesComponent.prototype.valid_extensions;
    /** @type {?} */
    UploadFilesComponent.prototype.fileList;
    /** @type {?} */
    UploadFilesComponent.prototype.isload;
    /** @type {?} */
    UploadFilesComponent.prototype.isShowDetail;
    /** @type {?} */
    UploadFilesComponent.prototype.errorMessage;
    /** @type {?} */
    UploadFilesComponent.prototype.warning;
    /** @type {?} */
    UploadFilesComponent.prototype.imageFormats;
    /** @type {?} */
    UploadFilesComponent.prototype.documentFormats;
    /** @type {?} */
    UploadFilesComponent.prototype.videoFormats;
    /** @type {?} */
    UploadFilesComponent.prototype.soundFormats;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.disabled;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.onChange;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.onTouched;
    /** @type {?} */
    UploadFilesComponent.prototype.preventAbuse;
    /** @type {?} */
    UploadFilesComponent.prototype.progressRef;
    /** @type {?} */
    UploadFilesComponent.prototype.getImageDimension;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.api;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.element;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.progress;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXBsb2FkLWltYWdlcy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Admljb2RlcnMvcmVhY3RpdmUtZm9ybS8iLCJzb3VyY2VzIjpbImxpYi9kaXJlY3RpdmVzL3VwbG9hZC1maWxlL3VwbG9hZC1pbWFnZXMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxLQUFLLENBQUMsTUFBTSxRQUFRLENBQUM7QUFDNUIsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUVyQyxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUE0QixRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDckgsT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsVUFBVSxFQUFpQixNQUFNLHVCQUF1QixDQUFDO0FBZ0JsRSxNQUFNLE9BQU8sb0JBQW9COzs7Ozs7OztJQTRDL0IsWUFDVSxRQUFrQixFQUNsQixHQUFnQixFQUNoQixPQUFtQixFQUNuQixJQUFnQixFQUNoQixRQUFvQjtRQUpwQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLFFBQUcsR0FBSCxHQUFHLENBQWE7UUFDaEIsWUFBTyxHQUFQLE9BQU8sQ0FBWTtRQUNuQixTQUFJLEdBQUosSUFBSSxDQUFZO1FBQ2hCLGFBQVEsR0FBUixRQUFRLENBQVk7UUE1QjlCLGVBQVUsR0FBUTtZQUNoQixPQUFPLEVBQUUsS0FBSztZQUNkLEtBQUssRUFBRSxLQUFLO1NBQ2IsQ0FBQztRQUVGLCtCQUEwQixHQUFHLENBQUMsQ0FBQztRQUcvQixhQUFRLEdBQUcsRUFBRSxDQUFDO1FBQ2QsV0FBTSxHQUFHLEtBQUssQ0FBQztRQUNmLGlCQUFZLEdBQUcsS0FBSyxDQUFDO1FBR3JCLGlCQUFZLEdBQUcsQ0FB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Ozs7O0lBQzNCLG9DQUF3Qjs7Ozs7SUFDeEIsd0NBQTRCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgRmlsZVNlcnZpY2UgfSBmcm9tICcuL3Rlc3QnO1xuZGVjbGFyZSBjb25zdCAkOiBhbnk7XG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIGZvcndhcmRSZWYsIEVsZW1lbnRSZWYsIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcywgSW5qZWN0b3IgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOR19WQUxVRV9BQ0NFU1NPUiB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBOZ1Byb2dyZXNzLCBOZ1Byb2dyZXNzUmVmIH0gZnJvbSAnQG5neC1wcm9ncmVzc2Jhci9jb3JlJztcblxuQENvbXBvbmVudCh7XG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgc2VsZWN0b3I6ICd1cGxvYWQtZmlsZScsXG4gIHRlbXBsYXRlVXJsOiAnLi91cGxvYWQtaW1hZ2VzLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vdXBsb2FkLWltYWdlcy5jb21wb25lbnQuY3NzJ10sXG4gIHByb3ZpZGVyczogW1xuICAgIEZpbGVTZXJ2aWNlLFxuICAgIHtcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gVXBsb2FkRmlsZXNDb21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWVcbiAgICB9XG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgVXBsb2FkRmlsZXNDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMge1xuICBASW5wdXQoKSBpZDogbnVtYmVyO1xuICBASW5wdXQoKSBoZWFkZXJzOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGFwaVVwbG9hZDogc3RyaW5nO1xuICBASW5wdXQoKSBhY2NlcHQ6IHN0cmluZztcbiAgQElucHV0KCkgYWxsb3dNYXhTaXplOiBhbnk7XG4gIEBJbnB1dCgpIHVwbG9hZFBhdGg6IGFueTtcbiAgQElucHV0KCkgbXVsdGlwbGU6IEJvb2xlYW47XG4gIEBJbnB1dCgpIF92YWx1ZTtcbiAgQElucHV0KCkgcmVzdWx0VHJhbnNmb3JtZXI7XG4gIEBJbnB1dCgpIHBhcmFtTmFtZTtcbiAgQElucHV0KCkgb2xkVmFsdWU7XG4gIEBJbnB1dCgpIGlzQ2xlYXI6IEJvb2xlYW47XG4gIEBJbnB1dCgpIHRpdGxlOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGRhdGFGdW5jdGlvbjogRnVuY3Rpb247XG4gIEBJbnB1dCgpIHVwbG9hZEZyb21EQjogYm9vbGVhbjtcbiAgQElucHV0KCkgd2lkdGg6IHN0cmluZztcbiAgQElucHV0KCkgbWF4V2lkdGg6IHN0cmluZztcbiAgQElucHV0KCkgaGVpZ2h0OiBzdHJpbmc7XG4gIEBJbnB1dCgpIG1heEhlaWdodDogc3RyaW5nO1xuXG4gIGluUHJvZ3Jlc3M6IGFueSA9IHtcbiAgICBwcm9jZXNzOiBmYWxzZSxcbiAgICBlcnJvcjogZmFsc2VcbiAgfTtcbiAgZmlsZXM7XG4gIG51bWJlcl9maWxlX3VwbG9hZF9zdWNjZXNzID0gMDtcbiAgcmVzcG9uc2VfZGF0YTtcbiAgdmFsaWRfZXh0ZW5zaW9ucztcbiAgZmlsZUxpc3QgPSBbXTtcbiAgaXNsb2FkID0gZmFsc2U7XG4gIGlzU2hvd0RldGFpbCA9IGZhbHNlO1xuICBlcnJvck1lc3NhZ2U7XG4gIHdhcm5pbmc7XG4gIGltYWdlRm9ybWF0cyA9IFsnanBnJywgJ2pwZWcnLCAncG5nJywgJ2dpZicsICdkanZ1JywgJ3JhdycsICdpY28nLCAnc3ZnJywgJ3RpZmYnLCAnYm1wJ107XG4gIGRvY3VtZW50Rm9ybWF0cyA9IFsncGRmJywgJ2RvYycsICdkb2N4JywgJ3hscycsICd4bHN4JywgJ3R4dCcsICdydGYnLCAnb2R0JywgJ3BwdCcsICdwcHR4JywgJ2NzdicsICd4bWwnXTtcbiAgdmlkZW9Gb3JtYXRzID0gWyczZ3AnLCAnYXNmJywgJ2F2aScsICdtb3YnLCAnbXA0JywgJ3JtJywgJ3ZvYicsICd3bXYnXTtcbiAgc291bmRGb3JtYXRzID0gWydtcDMnLCAnd21hJywgJ3dhdicsICdmbGFjJywgJ2FhYycsICdvZ2cnLCAnYWlmZicsICdhbGFjJ107XG4gIHByaXZhdGUgZGlzYWJsZWQ6IGJvb2xlYW47XG4gIHByaXZhdGUgb25DaGFuZ2U6IEZ1bmN0aW9uO1xuICBwcml2YXRlIG9uVG91Y2hlZDogRnVuY3Rpb247XG5cbiAgcHJldmVudEFidXNlID0gZmFsc2U7XG4gIHByb2dyZXNzUmVmOiBOZ1Byb2dyZXNzUmVmO1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcbiAgICBwcml2YXRlIGFwaTogRmlsZVNlcnZpY2UsXG4gICAgcHJpdmF0ZSBlbGVtZW50OiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcbiAgICBwcml2YXRlIHByb2dyZXNzOiBOZ1Byb2dyZXNzXG4gICkge1xuICAgIHRoaXMub25DaGFuZ2UgPSAodmFsOiBhbnkpID0+IHsgfTtcbiAgICB0aGlzLm9uVG91Y2hlZCA9ICgpID0+IHsgfTtcbiAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICB3cml0ZVZhbHVlKHZhbDogYW55KTogdm9pZCB7XG4gICAgaWYgKHZhbCkge1xuICAgICAgdGhpcy52YWx1ZSA9IHZhbDtcbiAgICB9XG4gIH1cblxuICBnZXQgdmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICB9XG5cbiAgc2V0IHZhbHVlKHZhbCkge1xuICAgIHRoaXMuX3ZhbHVlID0gdmFsO1xuICAgIHRoaXMub25DaGFuZ2UodGhpcy5fdmFsdWUpO1xuICB9XG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSk6IHZvaWQge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLm9uVG91Y2hlZCA9IGZuO1xuICB9XG5cbiAgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnByb2dyZXNzUmVmID0gdGhpcy5wcm9ncmVzcy5yZWYoJ3Byb2dyZXNzLWJhci0nICsgdGhpcy5pZCk7XG4gICAgICB0aGlzLmFjdGlvblJlbmRlcigpO1xuICAgIH0sIDEpO1xuICB9XG5cbiAgdXBsb2FkRmlsZShpZCkge1xuICAgIGNvbnN0ICR0aGlzID0gdGhpcztcbiAgICBpZiAodGhpcy5pblByb2dyZXNzWydwcm9jZXNzJ10gIT09IHRydWUpIHtcbiAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgIGlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICBpZiAoIV8uaXNOaWwodGhpcy5tdWx0aXBsZSkgJiYgdGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSkge1xuICAgICAgICBpbnB1dC5tdWx0aXBsZSA9IHRydWU7XG4gICAgICB9XG4gICAgICAkKGlucHV0KS50cmlnZ2VyKCdjbGljaycpO1xuICAgICAgJChpbnB1dCkub24oJ2NoYW5nZScsIGV2ZW50ID0+IHtcbiAgICAgICAgdGhpcy5udW1iZXJfZmlsZV91cGxvYWRfc3VjY2VzcyA9IDA7XG4gICAgICAgIHRoaXMuZmlsZXMgPSBpbnB1dC5maWxlcztcbiAgICAgICAgaWYgKHRoaXMuZmlsZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgIHRoaXMucmVzcG9uc2VfZGF0YSA9IFtdO1xuICAgICAgICAgIF8uZm9yRWFjaCh0aGlzLmZpbGVzLCBmdW5jdGlvbiAoZmlsZSkge1xuICAgICAgICAgICAgJHRoaXMudmFsaWRhdGVGaWxlKGZpbGUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpbGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIHRoaXMudmFsaWRhdGVGaWxlKHRoaXMuZmlsZXNbMF0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBuZ09uQ2hhbmdlcygpIHtcbiAgICBpZiAodGhpcy5pc0NsZWFyID09PSB0cnVlKSB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKCFfLmlzTmlsKHRoaXMubXVsdGlwbGUpICYmIHRoaXMubXVsdGlwbGUgPT09IHRydWUpIHtcbiAgICAgICAgICB0aGlzLm9sZFZhbHVlID0gW107XG4gICAgICAgICAgdGhpcy5maWxlTGlzdCA9IFtdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMub2xkVmFsdWUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0ICR0aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCFfLmlzTmlsKHRoaXMubXVsdGlwbGUpICYmIHRoaXMubXVsdGlwbGUgPT09IHRydWUgJiYgIV8uaXNFbXB0eSgkdGhpcy5vbGRWYWx1ZSkpIHtcbiAgICAgICAgICBfLmZvckVhY2godGhpcy5vbGRWYWx1ZSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAkdGhpcy5maWxlTGlzdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICR0aGlzLnZhbHVlID0gJHRoaXMuZmlsZUxpc3Q7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJHRoaXMudmFsdWUgPSAkdGhpcy5vbGRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgfSwgMSk7XG4gICAgfVxuICB9XG5cbiAgYWN0aW9uUmVuZGVyKCkge1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItY29uc3RcbiAgICBsZXQgJHRoaXMgPSB0aGlzO1xuICAgIHRoaXMuaXNsb2FkID0gdHJ1ZTtcbiAgICBpZiAoIV8uaXNOaWwodGhpcy5tdWx0aXBsZSkgJiYgdGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSAmJiAhXy5pc0VtcHR5KCR0aGlzLm9sZFZhbHVlKSkge1xuICAgICAgXy5mb3JFYWNoKHRoaXMub2xkVmFsdWUsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAkdGhpcy5maWxlTGlzdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgJHRoaXMudmFsdWUgPSAkdGhpcy5maWxlTGlzdDtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAkdGhpcy52YWx1ZSA9ICR0aGlzLm9sZFZhbHVlO1xuICAgIH1cbiAgICB0aGlzLmlzbG9hZCA9IGZhbHNlO1xuXG4gICAgaWYgKCFfLmlzVW5kZWZpbmVkKHRoaXMuYWNjZXB0KSkge1xuICAgICAgdGhpcy52YWxpZF9leHRlbnNpb25zID0gdGhpcy5hY2NlcHQuc3BsaXQoJ3wnKTtcbiAgICB9XG5cbiAgICAvLyAkKCcjdXBsb2FkZmlsZV92Mi1yZWFjdGl2ZS1mb3JtLScgKyB0aGlzLmlkKS5jbGljaygoKSA9PiB7XG4gICAgLy8gICBjb25zb2xlLmxvZyh0aGlzLmluUHJvZ3Jlc3MpO1xuICAgIC8vICAgaWYgKHRoaXMuaW5Qcm9ncmVzc1sncHJvY2VzcyddICE9PSB0cnVlKSB7XG4gICAgLy8gICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAvLyAgICAgaW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAvLyAgICAgaWYgKCFfLmlzTmlsKHRoaXMubXVsdGlwbGUpICYmIHRoaXMubXVsdGlwbGUgPT09IHRydWUpIHtcbiAgICAvLyAgICAgICBpbnB1dC5tdWx0aXBsZSA9IHRydWU7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgJChpbnB1dCkudHJpZ2dlcignY2xpY2snKTtcbiAgICAvLyAgICAgJChpbnB1dCkub24oJ2NoYW5nZScsIGV2ZW50ID0+IHtcbiAgICAvLyAgICAgICB0aGlzLm51bWJlcl9maWxlX3VwbG9hZF9zdWNjZXNzID0gMDtcbiAgICAvLyAgICAgICB0aGlzLmZpbGVzID0gaW5wdXQuZmlsZXM7XG4gICAgLy8gICAgICAgaWYgKHRoaXMuZmlsZXMubGVuZ3RoID4gMSkge1xuICAgIC8vICAgICAgICAgdGhpcy5yZXNwb25zZV9kYXRhID0gW107XG4gICAgLy8gICAgICAgICBfLmZvckVhY2godGhpcy5maWxlcywgZnVuY3Rpb24oZmlsZSkge1xuICAgIC8vICAgICAgICAgICAkdGhpcy52YWxpZGF0ZUZpbGUoZmlsZSk7XG4gICAgLy8gICAgICAgICB9KTtcbiAgICAvLyAgICAgICB9XG4gICAgLy8gICAgICAgaWYgKHRoaXMuZmlsZXMubGVuZ3RoID09PSAxKSB7XG4gICAgLy8gICAgICAgICB0aGlzLnZhbGlkYXRlRmlsZSh0aGlzLmZpbGVzWzBdKTtcbiAgICAvLyAgICAgICB9XG4gICAgLy8gICAgIH0pO1xuICAgIC8vICAgfVxuICAgIC8vIH0pO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgaWYgKCFfLmlzTmlsKHRoaXMubWF4V2lkdGgpKSB7XG4gICAgICB0aGlzLndhcm5pbmcgPSBgKlRoZSBpbWFnZSB3aWR0aCBzaG91bGQgYmUgc21hbGxlciAke3RoaXMubWF4V2lkdGh9YDtcbiAgICB9XG4gICAgaWYgKCFfLmlzTmlsKHRoaXMubWF4SGVpZ2h0KSkge1xuICAgICAgdGhpcy53YXJuaW5nID0gYCpUaGUgaW1hZ2Ugd2lkdGggc2hvdWxkIGJlIHNtYWxsZXIgJHt0aGlzLm1heEhlaWdodH1gO1xuICAgIH1cbiAgICBpZiAoIV8uaXNOaWwodGhpcy53aWR0aCkgJiYgIV8uaXNOaWwodGhpcy5oZWlnaHQpKSB7XG4gICAgICB0aGlzLndhcm5pbmcgPSBgKlJlY29tbWVuZGVkIHNpemU6ICR7dGhpcy53aWR0aH14JHt0aGlzLmhlaWdodH1gO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIV8uaXNOaWwodGhpcy53aWR0aCkpIHtcbiAgICAgICAgdGhpcy53YXJuaW5nID0gYCpSZWNvbW1lbmRlZCB3aWR0aDogJHt0aGlzLndpZHRofWA7XG4gICAgICB9XG4gICAgICBpZiAoIV8uaXNOaWwodGhpcy5oZWlnaHQpKSB7XG4gICAgICAgIHRoaXMud2FybmluZyA9IGAqUmVjb21tZW5kZWQgaGVpZ2h0OiAke3RoaXMuaGVpZ2h0fWA7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0RmlsZUV4dGVuc2lvbihmaWxlKSB7XG4gICAgcmV0dXJuIGZpbGUubmFtZS5zcGxpdCgnLicpLnBvcCgpO1xuICB9XG5cbiAgdmFsaWRhdGVGaWxlKGZpbGUpIHtcbiAgICBpZiAoZmlsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoIV8uaXNOaWwodGhpcy5hbGxvd01heFNpemUpICYmIHRoaXMuYWxsb3dNYXhTaXplICE9PSAnJykge1xuICAgICAgICBpZiAoZmlsZS5zaXplID4gcGFyc2VGbG9hdCh0aGlzLmFsbG93TWF4U2l6ZSkgKiAxMDI0ICogMTAyNCkge1xuICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gYFBsZWFzZSBzZWxlY3QgZmlsZSBsZXNzIHRoYW4gJHt0aGlzLmFsbG93TWF4U2l6ZX1NQmA7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoXG4gICAgICBpZiAoXG4gICAgICAgICFfLmlzVW5kZWZpbmVkKHRoaXMuYWNjZXB0KSAmJlxuICAgICAgICBfLmlzVW5kZWZpbmVkKF8uZmluZCh0aGlzLnZhbGlkX2V4dGVuc2lvbnMsIGl0ZW0gPT4gaXRlbS50b0xvd2VyQ2FzZSgpID09PSB0aGlzLmdldEZpbGVFeHRlbnNpb24oZmlsZSkudG9Mb3dlckNhc2UoKSkpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAnUGxlYXNlIHNlbGVjdCBhIGZpbGUgd2l0aCB2YWxpZCB0eXBlJztcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdGhpcy51cGxvYWQoZmlsZSk7XG4gICAgfVxuICB9XG5cbiAgdXBsb2FkKGZpbGUpIHtcbiAgICB0aGlzLnByZXZlbnRBYnVzZSA9IHRydWU7XG4gICAgdGhpcy5wcm9ncmVzc1JlZi5zdGFydCgpO1xuICAgIGNvbnN0IFVQTE9BRF9ESVJFQ1RJVkVfSEVBREVSUyA9IHRoaXMuaW5qZWN0b3IuZ2V0KCdVUExPQURfRElSRUNUSVZFX0hFQURFUlMnKTtcbiAgICBjb25zdCBVUExPQURfRElSRUNUSVZFX0FQSV9VUkwgPSB0aGlzLmluamVjdG9yLmdldCgnVVBMT0FEX0RJUkVDVElWRV9BUElfVVJMJyk7XG5cbiAgICB0aGlzLmlzbG9hZCA9IHRydWU7XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1jb25zdFxuICAgIGxldCAkdGhpcyA9IHRoaXM7XG4gICAgdGhpcy5pblByb2dyZXNzWydwcm9jZXNzJ10gPSB0cnVlO1xuXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1jb25zdFxuICAgIGxldCBwYXJhbXMgPSB7XG4gICAgICAvLyBmaWxlczogZmlsZVxuICAgICAgdXBsb2FkX3BhdGg6IHRoaXMudXBsb2FkUGF0aFxuICAgIH07XG4gICAgcGFyYW1zW3RoaXMucGFyYW1OYW1lXSA9IGZpbGU7XG4gICAgY29uc3QgcmVxdWVzdEhlYWRlcnMgPSBVUExPQURfRElSRUNUSVZFX0hFQURFUlM7XG4gICAgY29uc3QgcmVxdWVzdEFwaVVybCA9IFVQTE9BRF9ESVJFQ1RJVkVfQVBJX1VSTCArIHRoaXMuYXBpVXBsb2FkO1xuICAgIHRoaXMuYXBpLnVwbG9hZChwYXJhbXMsIHJlcXVlc3RBcGlVcmwsIHJlcXVlc3RIZWFkZXJzKS5zdWJzY3JpYmUoXG4gICAgICByZXNwb25zZSA9PiB7XG4gICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnByb2dyZXNzUmVmLmNvbXBsZXRlKCk7XG4gICAgICAgIHRoaXMuaW5Qcm9ncmVzc1sncHJvY2VzcyddID0gZmFsc2U7XG4gICAgICAgIHRoaXMubnVtYmVyX2ZpbGVfdXBsb2FkX3N1Y2Nlc3MrKztcbiAgICAgICAgaWYgKCFfLmlzTmlsKCR0aGlzLm11bHRpcGxlKSAmJiAkdGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICR0aGlzLmZpbGVMaXN0LnB1c2goJHRoaXMucmVzdWx0VHJhbnNmb3JtZXIocmVzcG9uc2UpKTtcbiAgICAgICAgICAkdGhpcy52YWx1ZSA9ICR0aGlzLmZpbGVMaXN0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICR0aGlzLnZhbHVlID0gJHRoaXMucmVzdWx0VHJhbnNmb3JtZXIocmVzcG9uc2UpO1xuICAgICAgICAgIGlmIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKCFfLmlzTmlsKCR0aGlzLndpZHRoKSB8fCAhXy5pc05pbCgkdGhpcy5oZWlnaHQpIHx8ICFfLmlzTmlsKCR0aGlzLm1heFdpZHRoKSB8fCAhXy5pc05pbCgkdGhpcy5tYXhIZWlnaHQpKSB7XG4gICAgICAgICAgICAgICR0aGlzLmdldEltYWdlRGltZW5zaW9uKHJlc3BvbnNlLmRhdGFbMF0uZnVsbF9wYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc2xvYWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBudWxsO1xuICAgICAgICB0aGlzLnByZXZlbnRBYnVzZSA9IGZhbHNlO1xuICAgICAgICAvLyB9LCA4MDApO1xuICAgICAgfSxcbiAgICAgIGVycm9yID0+IHtcbiAgICAgICAgdGhpcy5pc2xvYWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pblByb2dyZXNzWydwcm9jZXNzJ10gPSBmYWxzZTtcbiAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NSZWYuY29tcGxldGUoKTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZ2V0SW1hZ2VEaW1lbnNpb24gPSAoaW1nVXJsKSA9PiB7XG4gICAgbGV0IGNoZWNrID0gdHJ1ZTtcbiAgICBjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICBpbWcuc3JjID0gaW1nVXJsO1xuICAgIGltZy5vbmxvYWQgPSAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IGxvYWRlZEltYWdlOiBhbnkgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgY29uc3Qgd2lkdGggPSBsb2FkZWRJbWFnZS53aWR0aDtcbiAgICAgIGNvbnN0IGhlaWdodCA9IGxvYWRlZEltYWdlLmhlaWdodDtcbiAgICAgIGlmICghXy5pc05pbCh0aGlzLndpZHRoKSkge1xuICAgICAgICBpZiAod2lkdGggIT09IHRoaXMud2lkdGgpIHtcbiAgICAgICAgICBjaGVjayA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gYCpJbWFnZSB3aWR0aCBzaG91bGQgYmUgZXF1YWwgdG8gJHt0aGlzLndpZHRofXB4YDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCFfLmlzTmlsKHRoaXMubWF4V2lkdGgpKSB7XG4gICAgICAgIGlmICh3aWR0aCA+IHRoaXMubWF4V2lkdGgpIHtcbiAgICAgICAgICBjaGVjayA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gYCpJbWFnZSB3aWR0aCBzaG91bGQgYmUgc21hbGxlciAke3RoaXMubWF4V2lkdGh9cHhgO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIV8uaXNOaWwodGhpcy5oZWlnaHQpKSB7XG4gICAgICAgIGlmIChoZWlnaHQgIT09IHRoaXMuaGVpZ2h0KSB7XG4gICAgICAgICAgY2hlY2sgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGAqSW1hZ2UgaGVpZ2h0IHNob3VsZCBiZSBlcXVhbCB0byAke3RoaXMuaGVpZ2h0fXB4YDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCFfLmlzTmlsKHRoaXMubWF4SGVpZ2h0KSkge1xuICAgICAgICBpZiAoaGVpZ2h0ID4gdGhpcy5tYXhIZWlnaHQpIHtcbiAgICAgICAgICBjaGVjayA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gYCpJbWFnZSBoZWlnaHQgc2hvdWxkIGJlIHNtYWxsZXIgJHt0aGlzLm1heEhlaWdodH1weGA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghY2hlY2spIHtcbiAgICAgICAgdGhpcy53YXJuaW5nID0gbnVsbDtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgZGVsZXRlSXRlbShpdGVtKSB7XG4gICAgaWYgKHRoaXMubXVsdGlwbGUgPT09IHRydWUpIHtcbiAgICAgIHRoaXMuZmlsZUxpc3Quc3BsaWNlKHRoaXMuZmlsZUxpc3QuaW5kZXhPZihpdGVtKSwgMSk7XG4gICAgICB0aGlzLnZhbHVlID0gdGhpcy5maWxlTGlzdDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy52YWx1ZSA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgaXNJbmNsdWRlKHZhbHVlLCBhcnIpIHtcbiAgICBjb25zdCBhY2NlcHRzID0gdmFsdWUuc3BsaXQoJ3wnKTtcbiAgICBsZXQgcmVzdWx0ID0gdHJ1ZTtcbiAgICBfLmZvckVhY2goYWNjZXB0cywgZnVuY3Rpb24gKGkpIHtcbiAgICAgIGlmICghXy5maW5kKGFyciwgaXRlbSA9PiBpdGVtID09PSBpKSkge1xuICAgICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgZ2V0SWNvbihhY2NlcHRzKSB7XG4gICAgY29uc3QgJHRoaXMgPSB0aGlzO1xuICAgIGFjY2VwdHMgPSBhY2NlcHRzLnNwbGl0KCd8Jyk7XG4gICAgbGV0IHJlc3VsdCA9ICdmYS1leGNsYW1hdGlvbi10cmlhbmdsZSc7XG4gICAgXy5mb3JFYWNoKGFjY2VwdHMsIGZ1bmN0aW9uIChpKSB7XG4gICAgICBpZiAoXy5maW5kKCR0aGlzLmRvY3VtZW50Rm9ybWF0cywgaXRlbSA9PiBpdGVtID09PSBpKSkge1xuICAgICAgICByZXN1bHQgPSAnZmEtZmlsZS10ZXh0LW8nO1xuICAgICAgfVxuICAgICAgaWYgKF8uZmluZCgkdGhpcy52aWRlb0Zvcm1hdHMsIGl0ZW0gPT4gaXRlbSA9PT0gaSkpIHtcbiAgICAgICAgcmVzdWx0ID0gJ2ZhLWZpbGUtdmlkZW8tbyc7XG4gICAgICB9XG4gICAgICBpZiAoXy5maW5kKCR0aGlzLnNvdW5kRm9ybWF0cywgaXRlbSA9PiBpdGVtID09PSBpKSkge1xuICAgICAgICByZXN1bHQgPSAnZmEtZmlsZS1hdWRpby1vJztcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgb2tvaygpIHtcbiAgICB0aGlzLmRhdGFGdW5jdGlvbigpO1xuICB9XG59XG4iXX0=