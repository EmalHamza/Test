/**
 * @fileoverview added by tsickle
 * Generated from: lib/directives/upload-images/upload-images.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as _ from 'lodash';
import { FileService } from './test';
import { Component, Input, forwardRef, ElementRef, Injector } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
export class UploadImagesComponent {
    /**
     * @param {?} injector
     * @param {?} api
     * @param {?} element
     */
    constructor(injector, api, element) {
        this.injector = injector;
        this.api = api;
        this.element = element;
        this.inProgress = {
            process: false,
            error: false
        };
        this.number_file_upload_success = 0;
        this.fileList = [];
        this.isload = false;
        this.isShowDetail = false;
        this.imageFormats = ['jpg', 'jpeg', 'png', 'gif', 'tiff', 'bmp'];
        this.onChange = (/**
         * @param {?} val
         * @return {?}
         */
        (val) => { });
        this.onTouched = (/**
         * @return {?}
         */
        () => { });
        this.disabled = false;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    writeValue(val) {
        if (val) {
            this.value = val;
        }
    }
    /**
     * @return {?}
     */
    get value() {
        return this._value;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set value(val) {
        this._value = val;
        this.onChange(this._value);
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.actionRender();
        }), 1);
    }
    /**
     * @return {?}
     */
    ngOnChanges() {
        if (this.isClear === true) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                if (!_.isNil(this.multiple) && this.multiple === true) {
                    this.oldValue = [];
                    this.fileList = [];
                }
                else {
                    this.oldValue = null;
                }
                /** @type {?} */
                const $this = this;
                if (!_.isNil(this.multiple) && this.multiple === true && !_.isEmpty($this.oldValue)) {
                    _.forEach(this.oldValue, (/**
                     * @param {?} value
                     * @return {?}
                     */
                    function (value) {
                        $this.fileList.push(value);
                        $this.value = $this.fileList;
                    }));
                }
                else {
                    $this.value = $this.oldValue;
                }
            }), 1);
        }
    }
    /**
     * @return {?}
     */
    actionRender() {
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        let $this = this;
        this.isload = true;
        if (!_.isNil(this.multiple) && this.multiple === true && !_.isEmpty($this.oldValue)) {
            _.forEach(this.oldValue, (/**
             * @param {?} value
             * @return {?}
             */
            function (value) {
                $this.fileList.push(value);
                $this.value = $this.fileList;
            }));
        }
        else {
            $this.value = $this.oldValue;
        }
        this.isload = false;
        if (!_.isUndefined(this.accept)) {
            this.valid_extensions = this.accept.split('|');
        }
        $('#uploadfile-reactive-form-' + this.id).click((/**
         * @return {?}
         */
        () => {
            if (this.inProgress[this.subProgress] !== true) {
                // tslint:disable-next-line:prefer-const
                /** @type {?} */
                let input = document.createElement('input');
                input.type = 'file';
                if (!_.isNil(this.multiple) && this.multiple === true) {
                    input.multiple = true;
                }
                $(input).trigger('click');
                $(input).on('change', (/**
                 * @param {?} event
                 * @return {?}
                 */
                event => {
                    this.number_file_upload_success = 0;
                    this.files = input.files;
                    if (this.files.length > 1) {
                        this.response_data = [];
                        _.forEach(this.files, (/**
                         * @param {?} file
                         * @return {?}
                         */
                        function (file) {
                            $this.validateFile(file);
                        }));
                    }
                    if (this.files.length === 1) {
                        this.validateFile(this.files[0]);
                    }
                }));
            }
        }));
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @param {?} file
     * @return {?}
     */
    getFileExtension(file) {
        return file.name.split('.').pop();
    }
    /**
     * @param {?} file
     * @return {?}
     */
    validateFile(file) {
        if (file !== undefined) {
            if (!_.isNil(this.allowMaxSize) && this.allowMaxSize !== '') {
                if (file.size > parseFloat(this.allowMaxSize) * 1024 * 1024) {
                    this.errorMessage = `Please select file less than ${this.allowMaxSize}MB`;
                    return false;
                }
            }
            // tslint:disable-next-line:max-line-length
            if (!_.isUndefined(this.accept) &&
                _.isUndefined(_.find(this.valid_extensions, (/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.toLowerCase() === this.getFileExtension(file).toLowerCase())))) {
                this.errorMessage = 'Please select a file with valid type';
                return false;
            }
            this.upload(file);
        }
    }
    /**
     * @param {?} file
     * @return {?}
     */
    upload(file) {
        /** @type {?} */
        const UPLOAD_DIRECTIVE_HEADERS = this.injector.get('UPLOAD_DIRECTIVE_HEADERS');
        /** @type {?} */
        const UPLOAD_DIRECTIVE_API_URL = this.injector.get('UPLOAD_DIRECTIVE_API_URL');
        this.isload = true;
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        let $this = this;
        this.inProgress[this.subProgress] = true;
        this.inProgress[this.subError] = false;
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        let params = {
            // files: file
            upload_path: this.uploadPath
        };
        params[this.paramName] = file;
        /** @type {?} */
        const requestHeaders = UPLOAD_DIRECTIVE_HEADERS;
        /** @type {?} */
        const requestApiUrl = UPLOAD_DIRECTIVE_API_URL + this.apiUpload;
        this.api.upload(params, requestApiUrl, requestHeaders).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        response => {
            this.inProgress[this.subProgress] = false;
            this.number_file_upload_success++;
            if (!_.isNil($this.multiple) && $this.multiple === true) {
                if (!$this.zoom) {
                    $this.fileList.push($this.resultTransformer(response));
                }
                else {
                    $this.fileList.push({ url: $this.resultTransformer(response), urlZoom: $this.resultTransformer(response) });
                }
                $this.value = $this.fileList;
            }
            else {
                if (!$this.zoom) {
                    $this.value = $this.resultTransformer(response);
                }
                else {
                    $this.value = { url: $this.resultTransformer(response), urlZoom: $this.resultTransformer(response) };
                }
            }
            this.isload = false;
            this.errorMessage = null;
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            this.isload = false;
            this.inProgress[this.subProgress] = false;
            this.inProgress[this.subError] = true;
            console.log('error', error);
        }));
    }
    /**
     * @param {?} item
     * @return {?}
     */
    deleteItem(item) {
        this.fileList.splice(this.fileList.indexOf(item), 1);
        this.value = this.fileList;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    showDetail(val) {
        this.isShowDetail = true;
        this.urlDetail = val;
    }
    /**
     * @return {?}
     */
    closeDetail() {
        this.isShowDetail = false;
    }
    /**
     * @param {?} value
     * @param {?} arr
     * @return {?}
     */
    isInclude(value, arr) {
        /** @type {?} */
        const accepts = value.split('|');
        /** @type {?} */
        let result = true;
        _.forEach(accepts, (/**
         * @param {?} i
         * @return {?}
         */
        function (i) {
            if (!_.find(arr, (/**
             * @param {?} item
             * @return {?}
             */
            item => item === i))) {
                result = false;
            }
        }));
        return result;
    }
}
UploadImagesComponent.decorators = [
    { type: Component, args: [{
                // tslint:disable-next-line:component-selector
                selector: 'upload-images',
                template: "<div class=\"row\" *ngIf=\"isInclude(accept, imageFormats)\">\n  <div class=\"col-md-12 form-wrapper\" style=\"margin-bottom: 15px;\">\n    <div class=\"signle-img\" *ngIf=\"(!multiple && value) || (multiple === false && value)\">\n      <ng-container *ngIf=\"!zoom\">\n        <img [ngStyle]=\"{\n          'background-image': 'url(' + value + ')',\n          'background-position': 'center',\n          'background-repeat': 'no-repeat',\n          'background-size': 'cover'\n        }\" (click)=\"showDetail(value)\"\n          src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlEMjQ4QkVCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTlEMjQ4Q0VCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5OUQyNDg5RUJCRTExRThCRDY3OURGRUFDRDA0RTREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY5OUQyNDhBRUJCRTExRThCRDY3OURGRUFDRDA0RTREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+O7rz2AAAASBJREFUeNrs0jERAAAIxDDAv+fHACNjIqHXTlLwbSTAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsuK0AAwBL0gQp9PLLgwAAAABJRU5ErkJggg==\"\n          width=\"100\" alt=\"\" />\n      </ng-container>\n      <ng-container *ngIf=\"zoom\">\n        <img [ngStyle]=\"{\n          'background-image': 'url(' + value.url + ')',\n          'background-position': 'center',\n          'background-repeat': 'no-repeat',\n          'background-size': 'cover'\n        }\" (click)=\"showDetail(value)\"\n          src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlEMjQ4QkVCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTlEMjQ4Q0VCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5OUQyNDg5RUJCRTExRThCRDY3OURGRUFDRDA0RTREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY5OUQyNDhBRUJCRTExRThCRDY3OURGRUFDRDA0RTREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+O7rz2AAAASBJREFUeNrs0jERAAAIxDDAv+fHACNjIqHXTlLwbSTAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsuK0AAwBL0gQp9PLLgwAAAABJRU5ErkJggg==\"\n          width=\"100\" alt=\"\" />\n      </ng-container>\n    </div>\n    <div class=\"mutil-img\" *ngIf=\"multiple === true\">\n      <div class=\"group-item\" *ngFor=\"let item of value\">\n        <ng-container *ngIf=\"!zoom\">\n          <img [ngStyle]=\"{\n            'background-image': 'url(' + item + ')',\n            'background-position': 'center',\n            'background-repeat': 'no-repeat',\n            'background-size': 'cover'\n          }\" (click)=\"showDetail(item)\" class=\"singleImg\" alt=\"\"\n            src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlEMjQ4QkVCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTlEMjQ4Q0VCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5OUQyNDg5RUJCRTExRThCRDY3OURGRUFDRDA0RTREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY5OUQyNDhBRUJCRTExRThCRDY3OURGRUFDRDA0RTREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+O7rz2AAAASBJREFUeNrs0jERAAAIxDDAv+fHACNjIqHXTlLwbSTAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsuK0AAwBL0gQp9PLLgwAAAABJRU5ErkJggg==\" />\n          <span (click)=\"deleteItem(item)\">Remove</span>\n        </ng-container>\n        <ng-container *ngIf=\"zoom\">\n          <img [ngStyle]=\"{\n            'background-image': 'url(' + item.url + ')',\n            'background-position': 'center',\n            'background-repeat': 'no-repeat',\n            'background-size': 'cover'\n          }\" (click)=\"showDetail(item)\" class=\"singleImg\" alt=\"\"\n            src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlEMjQ4QkVCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTlEMjQ4Q0VCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5OUQyNDg5RUJCRTExRThCRDY3OURGRUFDRDA0RTREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY5OUQyNDhBRUJCRTExRThCRDY3OURGRUFDRDA0RTREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+O7rz2AAAASBJREFUeNrs0jERAAAIxDDAv+fHACNjIqHXTlLwbSTAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsuK0AAwBL0gQp9PLLgwAAAABJRU5ErkJggg==\" />\n          <span (click)=\"deleteItem(item)\">Remove</span>\n        </ng-container>\n      </div>\n      <div class=\"loader-img add-icon\" *ngIf=\"isload\"></div>\n      <div id=\"uploadfile-reactive-form-{{ id }}\" class=\"plus icon add-icon\"></div>\n    </div>\n    <div class=\"loader-img add-icon\" *ngIf=\"(isload && multiple === false) || (isload && !multiple)\"></div>\n    <div *ngIf=\"multiple === false || !multiple\" id=\"uploadfile-reactive-form-{{ id }}\" class=\"plus icon add-icon\">\n    </div>\n  </div>\n</div>\n\n<div class=\"row\" *ngIf=\"!isInclude(accept, imageFormats)\">\n  <div class=\"col-md-12\" style=\"margin-bottom: 15px;\">\n    <div class=\"form-group\" *ngIf=\"(!multiple && value) || (multiple === false && value)\">\n      <p><i class=\"fa fa-file-text-o\" aria-hidden=\"true\"></i> {{ value }}</p>\n    </div>\n    <div class=\"mutil-img\" *ngIf=\"multiple === true\">\n      <div *ngFor=\"let item of value\">\n        <p>\n          <i class=\"fa fa-file-text-o\" aria-hidden=\"true\"></i> {{ item\n          }}<i (click)=\"deleteItem(item)\" class=\"fa fa-times\" aria-hidden=\"true\"></i>\n        </p>\n      </div>\n    </div>\n    <div class=\"form-group\">\n      <div class=\"btn btn-primary btn-upload-file\" id=\"uploadfile-reactive-form-{{ id }}\">\n        <div class=\"loader-img add-icon\" *ngIf=\"isload\"></div>\n        Select files\n      </div>\n    </div>\n  </div>\n</div>\n\n<div *ngIf=\"isShowDetail && isInclude(accept, imageFormats)\" class=\"mask-wrapper\">\n  <div (click)=\"closeDetail()\" class=\"remove icon close\"></div>\n  <!-- <img src=\"{{ urlDetail }}\" alt=\"\" /> -->\n  <ng-container *ngIf=\"!zoom\">\n    <img [ngStyle]=\"{\n      'background-image': 'url(' + urlDetail + ')',\n      'background-position': 'center',\n      'background-repeat': 'no-repeat',\n      'background-size': 'cover'\n    }\"\n      src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAMgAQMAAADhvpQrAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAANQTFRFAAAAp3o92gAAAAF0Uk5TAEDm2GYAAABlSURBVHic7cExAQAAAMKg9U9tBn+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeAw7rwABQNMlhwAAAABJRU5ErkJggg==\"\n      alt=\"\" />\n  </ng-container>\n  <ng-container *ngIf=\"zoom\">\n    <img [ngStyle]=\"{\n      'background-image': 'url(' + urlDetail.urlZoom + ')',\n      'background-position': 'center',\n      'background-repeat': 'no-repeat',\n      'background-size': 'cover'\n    }\"\n      src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAMgAQMAAADhvpQrAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAANQTFRFAAAAp3o92gAAAAF0Uk5TAEDm2GYAAABlSURBVHic7cExAQAAAMKg9U9tBn+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeAw7rwABQNMlhwAAAABJRU5ErkJggg==\"\n      alt=\"\" />\n  </ng-container>\n</div>\n\n<div *ngIf=\"errorMessage\" class=\"error-message\">{{ errorMessage }}</div>",
                providers: [
                    FileService,
                    {
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => UploadImagesComponent)),
                        multi: true
                    }
                ],
                styles: [".row{margin-top:15px}.mutil-img .group-item .singleImg,.signle-img{border:1px solid grey;padding:3px;box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23)}.mutil-img,.signle-img{display:inline-block}.mutil-img .group-item{display:inline-block;position:relative;margin-right:5px;margin-bottom:30px}.mutil-img .group-item span{position:absolute;left:50%;bottom:-25px;margin-left:-25px;cursor:pointer}.mutil-img .group-item span:hover{text-decoration:underline;color:grey}.add-icon{margin-left:30px;margin-bottom:25px;cursor:pointer;display:inline-block}img{cursor:pointer}body{position:relative}.mask-wrapper{position:fixed;top:0;left:0;background-color:rgba(0,0,0,.8);width:100%;height:100%;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;z-index:99999}.close{position:absolute;top:50px;color:#fff;right:100px;cursor:pointer}.remove.icon{color:#000;position:absolute;margin-left:3px;margin-top:10px;padding:20px}.remove.icon:before{content:'';position:absolute;left:2px;width:30px;height:5px;background-color:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.remove.icon:after{content:'';position:absolute;width:30px;left:2px;height:5px;background-color:#fff;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.loader-img{border:3px solid #f3f3f3;border-radius:50%;border-top:3px solid #3498db;width:36px;height:36px;-webkit-animation:2s linear infinite spin;animation:2s linear infinite spin}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.plus.icon{color:#000;position:relative;width:65px;height:65px;border:3px solid #000;border-radius:50%;cursor:pointer}.plus.icon:before{content:'';position:absolute;width:30px;height:3px;background-color:#000;top:50%;left:50%;margin-left:-15px}.plus.icon:after{content:'';position:absolute;width:30px;height:3px;background-color:#000;-webkit-transform:rotate(90deg);transform:rotate(90deg);top:48%;left:24%}.form-wrapper{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.form-wrapper .signle-img{width:100px;min-height:100px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.form-wrapper .signle-img img{width:100%}.form-wrapper .mutil-img{display:-webkit-box;display:flex;margin-bottom:33px;flex-wrap:wrap;-webkit-box-align:center;align-items:center}.form-wrapper .mutil-img img{width:100px}.error-message{color:red;margin-top:15px}.btn-upload-file{position:relative}.btn-upload-file .add-icon{position:absolute;right:-50px;top:0}.fa-times{margin-left:15px;cursor:pointer;color:#cd5c5c}"]
            }] }
];
/** @nocollapse */
UploadImagesComponent.ctorParameters = () => [
    { type: Injector },
    { type: FileService },
    { type: ElementRef }
];
UploadImagesComponent.propDecorators = {
    id: [{ type: Input }],
    headers: [{ type: Input }],
    apiUpload: [{ type: Input }],
    accept: [{ type: Input }],
    subProgress: [{ type: Input }],
    subError: [{ type: Input }],
    allowMaxSize: [{ type: Input }],
    uploadPath: [{ type: Input }],
    multiple: [{ type: Input }],
    _value: [{ type: Input }],
    resultTransformer: [{ type: Input }],
    paramName: [{ type: Input }],
    oldValue: [{ type: Input }],
    isClear: [{ type: Input }],
    zoom: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    UploadImagesComponent.prototype.id;
    /** @type {?} */
    UploadImagesComponent.prototype.headers;
    /** @type {?} */
    UploadImagesComponent.prototype.apiUpload;
    /** @type {?} */
    UploadImagesComponent.prototype.accept;
    /** @type {?} */
    UploadImagesComponent.prototype.subProgress;
    /** @type {?} */
    UploadImagesComponent.prototype.subError;
    /** @type {?} */
    UploadImagesComponent.prototype.allowMaxSize;
    /** @type {?} */
    UploadImagesComponent.prototype.uploadPath;
    /** @type {?} */
    UploadImagesComponent.prototype.multiple;
    /** @type {?} */
    UploadImagesComponent.prototype._value;
    /** @type {?} */
    UploadImagesComponent.prototype.resultTransformer;
    /** @type {?} */
    UploadImagesComponent.prototype.paramName;
    /** @type {?} */
    UploadImagesComponent.prototype.oldValue;
    /** @type {?} */
    UploadImagesComponent.prototype.isClear;
    /** @type {?} */
    UploadImagesComponent.prototype.zoom;
    /** @type {?} */
    UploadImagesComponent.prototype.inProgress;
    /** @type {?} */
    UploadImagesComponent.prototype.files;
    /** @type {?} */
    UploadImagesComponent.prototype.number_file_upload_success;
    /** @type {?} */
    UploadImagesComponent.prototype.response_data;
    /** @type {?} */
    UploadImagesComponent.prototype.valid_extensions;
    /** @type {?} */
    UploadImagesComponent.prototype.fileList;
    /** @type {?} */
    UploadImagesComponent.prototype.isload;
    /** @type {?} */
    UploadImagesComponent.prototype.isShowDetail;
    /** @type {?} */
    UploadImagesComponent.prototype.urlDetail;
    /** @type {?} */
    UploadImagesComponent.prototype.errorMessage;
    /** @type {?} */
    UploadImagesComponent.prototype.imageFormats;
    /**
     * @type {?}
     * @private
     */
    UploadImagesComponent.prototype.disabled;
    /**
     * @type {?}
     * @private
     */
    UploadImagesComponent.prototype.onChange;
    /**
     * @type {?}
     * @private
     */
    UploadImagesComponent.prototype.onTouched;
    /**
     * @type {?}
     * @private
     */
    UploadImagesComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    UploadImagesComponent.prototype.api;
    /**
     * @type {?}
     * @private
     */
    UploadImagesComponent.prototype.element;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXBsb2FkLWltYWdlcy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Admljb2RlcnMvcmVhY3RpdmUtZm9ybS8iLCJzb3VyY2VzIjpbImxpYi9kaXJlY3RpdmVzL3VwbG9hZC1pbWFnZXMvdXBsb2FkLWltYWdlcy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEtBQUssQ0FBQyxNQUFNLFFBQVEsQ0FBQztBQUM1QixPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBRXJDLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQTRCLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNySCxPQUFPLEVBQXdCLGlCQUFpQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFnQnpFLE1BQU0sT0FBTyxxQkFBcUI7Ozs7OztJQWlDaEMsWUFBb0IsUUFBa0IsRUFBVSxHQUFnQixFQUFVLE9BQW1CO1FBQXpFLGFBQVEsR0FBUixRQUFRLENBQVU7UUFBVSxRQUFHLEdBQUgsR0FBRyxDQUFhO1FBQVUsWUFBTyxHQUFQLE9BQU8sQ0FBWTtRQWpCN0YsZUFBVSxHQUFRO1lBQ2hCLE9BQU8sRUFBRSxLQUFLO1lBQ2QsS0FBSyxFQUFFLEtBQUs7U0FDYixDQUFDO1FBRUYsK0JBQTBCLEdBQUcsQ0FBQyxDQUFDO1FBRy9CLGFBQVEsR0FBRyxFQUFFLENBQUM7UUFDZCxXQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ2YsaUJBQVksR0FBRyxLQUFLLENBQUM7UUFHckIsaUJBQVksR0FBRyxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFLMUQsSUFBSSxDQUFDLFFBQVE7Ozs7UUFBRyxDQUFDLEdBQVEsRUFBRSxFQUFFLEdBQUUsQ0FBQyxDQUFBLENBQUM7UUFDakMsSUFBSSxDQUFDLFNBQVM7OztRQUFHLEdB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ZTtnQkFDekIsOGtXQUE2QztnQkFFN0MsU0FBUyxFQUFFO29CQUNULFdBQVc7b0JBQ1g7d0JBQ0UsT0FBTyxFQUFFLGlCQUFpQjt3QkFDMUIsV0FBVyxFQUFFLFVBQVU7Ozt3QkFBQyxHQUFHLEVBQUUsQ0FBQyxxQkFBcUIsRUFBQzt3QkFDcEQsS0FBSyxFQUFFLElBQUk7cUJBQ1o7aUJBQ0Y7O2FBQ0Y7Ozs7WUFoQm9GLFFBQVE7WUFGcEYsV0FBVztZQUUyQixVQUFVOzs7aUJBa0J0RCxLQUFLO3NCQUNMLEtBQUs7d0JBQ0wsS0FBSztxQkFDTCxLQUFLOzBCQUNMLEtBQUs7dUJBQ0wsS0FBSzsyQkFDTCxLQUFLO3lCQUNMLEtBQUs7dUJBQ0wsS0FBSztxQkFDTCxLQUFLO2dDQUNMLEtBQUs7d0JBQ0wsS0FBSzt1QkFDTCxLQUFLO3NCQUNMLEtBQUs7bUJBQ0wsS0FBSzs7OztJQWROLG1DQUFvQjs7SUFDcEIsd0NBQXlCOztJQUN6QiwwQ0FBMkI7O0lBQzNCLHVDQUF3Qjs7SUFDeEIsNENBQTBCOztJQUMxQix5Q0FBdUI7O0lBQ3ZCLDZDQUEyQjs7SUFDM0IsMkNBQXlCOztJQUN6Qix5Q0FBMkI7O0lBQzNCLHVDQUFnQjs7SUFDaEIsa0RBQTJCOztJQUMzQiwwQ0FBbUI7O0lBQ25CLHlDQUFrQjs7SUFDbEIsd0NBQTBCOztJQUMxQixxQ0FBdUI7O0lBQ3ZCLDJDQUdFOztJQUNGLHNDQUFNOztJQUNOLDJEQUErQjs7SUFDL0IsOENBQWM7O0lBQ2QsaURBQWlCOztJQUNqQix5Q0FBYzs7SUFDZCx1Q0FBZTs7SUFDZiw2Q0FBcUI7O0lBQ3JCLDBDQUFVOztJQUNWLDZDQUFhOztJQUNiLDZDQUE0RDs7Ozs7SUFDNUQseUNBQTBCOzs7OztJQUMxQix5Q0FBMkI7Ozs7O0lBQzNCLDBDQUE0Qjs7Ozs7SUFDaEIseUNBQTBCOzs7OztJQUFFLG9DQUF3Qjs7Ozs7SUFBRSx3Q0FBMkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBGaWxlU2VydmljZSB9IGZyb20gJy4vdGVzdCc7XG5kZWNsYXJlIGNvbnN0ICQ6IGFueTtcbmltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgZm9yd2FyZFJlZiwgRWxlbWVudFJlZiwgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzLCBJbmplY3RvciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuXG5AQ29tcG9uZW50KHtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxuICBzZWxlY3RvcjogJ3VwbG9hZC1pbWFnZXMnLFxuICB0ZW1wbGF0ZVVybDogJy4vdXBsb2FkLWltYWdlcy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3VwbG9hZC1pbWFnZXMuY29tcG9uZW50LmNzcyddLFxuICBwcm92aWRlcnM6IFtcbiAgICBGaWxlU2VydmljZSxcbiAgICB7XG4gICAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFVwbG9hZEltYWdlc0NvbXBvbmVudCksXG4gICAgICBtdWx0aTogdHJ1ZVxuICAgIH1cbiAgXVxufSlcbmV4cG9ydCBjbGFzcyBVcGxvYWRJbWFnZXNDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMge1xuICBASW5wdXQoKSBpZDogbnVtYmVyO1xuICBASW5wdXQoKSBoZWFkZXJzOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGFwaVVwbG9hZDogc3RyaW5nO1xuICBASW5wdXQoKSBhY2NlcHQ6IHN0cmluZztcbiAgQElucHV0KCkgc3ViUHJvZ3Jlc3M6IGFueTtcbiAgQElucHV0KCkgc3ViRXJyb3I6IGFueTtcbiAgQElucHV0KCkgYWxsb3dNYXhTaXplOiBhbnk7XG4gIEBJbnB1dCgpIHVwbG9hZFBhdGg6IGFueTtcbiAgQElucHV0KCkgbXVsdGlwbGU6IEJvb2xlYW47XG4gIEBJbnB1dCgpIF92YWx1ZTtcbiAgQElucHV0KCkgcmVzdWx0VHJhbnNmb3JtZXI7XG4gIEBJbnB1dCgpIHBhcmFtTmFtZTtcbiAgQElucHV0KCkgb2xkVmFsdWU7XG4gIEBJbnB1dCgpIGlzQ2xlYXI6IEJvb2xlYW47XG4gIEBJbnB1dCgpIHpvb206IEJvb2xlYW47XG4gIGluUHJvZ3Jlc3M6IGFueSA9IHtcbiAgICBwcm9jZXNzOiBmYWxzZSxcbiAgICBlcnJvcjogZmFsc2VcbiAgfTtcbiAgZmlsZXM7XG4gIG51bWJlcl9maWxlX3VwbG9hZF9zdWNjZXNzID0gMDtcbiAgcmVzcG9uc2VfZGF0YTtcbiAgdmFsaWRfZXh0ZW5zaW9ucztcbiAgZmlsZUxpc3QgPSBbXTtcbiAgaXNsb2FkID0gZmFsc2U7XG4gIGlzU2hvd0RldGFpbCA9IGZhbHNlO1xuICB1cmxEZXRhaWw7XG4gIGVycm9yTWVzc2FnZTtcbiAgaW1hZ2VGb3JtYXRzID0gWydqcGcnLCAnanBlZycsICdwbmcnLCAnZ2lmJywgJ3RpZmYnLCAnYm1wJ107XG4gIHByaXZhdGUgZGlzYWJsZWQ6IGJvb2xlYW47XG4gIHByaXZhdGUgb25DaGFuZ2U6IEZ1bmN0aW9uO1xuICBwcml2YXRlIG9uVG91Y2hlZDogRnVuY3Rpb247XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLCBwcml2YXRlIGFwaTogRmlsZVNlcnZpY2UsIHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZikge1xuICAgIHRoaXMub25DaGFuZ2UgPSAodmFsOiBhbnkpID0+IHt9O1xuICAgIHRoaXMub25Ub3VjaGVkID0gKCkgPT4ge307XG4gICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgd3JpdGVWYWx1ZSh2YWw6IGFueSk6IHZvaWQge1xuICAgIGlmICh2YWwpIHtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWw7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgfVxuXG4gIHNldCB2YWx1ZSh2YWwpIHtcbiAgICB0aGlzLl92YWx1ZSA9IHZhbDtcbiAgICB0aGlzLm9uQ2hhbmdlKHRoaXMuX3ZhbHVlKTtcbiAgfVxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLm9uQ2hhbmdlID0gZm47XG4gIH1cblxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KTogdm9pZCB7XG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5hY3Rpb25SZW5kZXIoKTtcbiAgICB9LCAxKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIGlmICh0aGlzLmlzQ2xlYXIgPT09IHRydWUpIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAoIV8uaXNOaWwodGhpcy5tdWx0aXBsZSkgJiYgdGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgIHRoaXMub2xkVmFsdWUgPSBbXTtcbiAgICAgICAgICB0aGlzLmZpbGVMaXN0ID0gW107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5vbGRWYWx1ZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgJHRoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIV8uaXNOaWwodGhpcy5tdWx0aXBsZSkgJiYgdGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSAmJiAhXy5pc0VtcHR5KCR0aGlzLm9sZFZhbHVlKSkge1xuICAgICAgICAgIF8uZm9yRWFjaCh0aGlzLm9sZFZhbHVlLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAkdGhpcy5maWxlTGlzdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgJHRoaXMudmFsdWUgPSAkdGhpcy5maWxlTGlzdDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkdGhpcy52YWx1ZSA9ICR0aGlzLm9sZFZhbHVlO1xuICAgICAgICB9XG4gICAgICB9LCAxKTtcbiAgICB9XG4gIH1cblxuICBhY3Rpb25SZW5kZXIoKSB7XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1jb25zdFxuICAgIGxldCAkdGhpcyA9IHRoaXM7XG4gICAgdGhpcy5pc2xvYWQgPSB0cnVlO1xuICAgIGlmICghXy5pc05pbCh0aGlzLm11bHRpcGxlKSAmJiB0aGlzLm11bHRpcGxlID09PSB0cnVlICYmICFfLmlzRW1wdHkoJHRoaXMub2xkVmFsdWUpKSB7XG4gICAgICBfLmZvckVhY2godGhpcy5vbGRWYWx1ZSwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgJHRoaXMuZmlsZUxpc3QucHVzaCh2YWx1ZSk7XG4gICAgICAgICR0aGlzLnZhbHVlID0gJHRoaXMuZmlsZUxpc3Q7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHRoaXMudmFsdWUgPSAkdGhpcy5vbGRWYWx1ZTtcbiAgICB9XG4gICAgdGhpcy5pc2xvYWQgPSBmYWxzZTtcblxuICAgIGlmICghXy5pc1VuZGVmaW5lZCh0aGlzLmFjY2VwdCkpIHtcbiAgICAgIHRoaXMudmFsaWRfZXh0ZW5zaW9ucyA9IHRoaXMuYWNjZXB0LnNwbGl0KCd8Jyk7XG4gICAgfVxuXG4gICAgJCgnI3VwbG9hZGZpbGUtcmVhY3RpdmUtZm9ybS0nICsgdGhpcy5pZCkuY2xpY2soKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaW5Qcm9ncmVzc1t0aGlzLnN1YlByb2dyZXNzXSAhPT0gdHJ1ZSkge1xuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWNvbnN0XG4gICAgICAgIGxldCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIGlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICAgIGlmICghXy5pc05pbCh0aGlzLm11bHRpcGxlKSAmJiB0aGlzLm11bHRpcGxlID09PSB0cnVlKSB7XG4gICAgICAgICAgaW5wdXQubXVsdGlwbGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgICQoaW5wdXQpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgICAgICQoaW5wdXQpLm9uKCdjaGFuZ2UnLCBldmVudCA9PiB7XG4gICAgICAgICAgdGhpcy5udW1iZXJfZmlsZV91cGxvYWRfc3VjY2VzcyA9IDA7XG4gICAgICAgICAgdGhpcy5maWxlcyA9IGlucHV0LmZpbGVzO1xuXG4gICAgICAgICAgaWYgKHRoaXMuZmlsZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZV9kYXRhID0gW107XG4gICAgICAgICAgICBfLmZvckVhY2godGhpcy5maWxlcywgZnVuY3Rpb24oZmlsZSkge1xuICAgICAgICAgICAgICAkdGhpcy52YWxpZGF0ZUZpbGUoZmlsZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuZmlsZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlRmlsZSh0aGlzLmZpbGVzWzBdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7fVxuXG4gIGdldEZpbGVFeHRlbnNpb24oZmlsZSkge1xuICAgIHJldHVybiBmaWxlLm5hbWUuc3BsaXQoJy4nKS5wb3AoKTtcbiAgfVxuXG4gIHZhbGlkYXRlRmlsZShmaWxlKSB7XG4gICAgaWYgKGZpbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKCFfLmlzTmlsKHRoaXMuYWxsb3dNYXhTaXplKSAmJiB0aGlzLmFsbG93TWF4U2l6ZSAhPT0gJycpIHtcbiAgICAgICAgaWYgKGZpbGUuc2l6ZSA+IHBhcnNlRmxvYXQodGhpcy5hbGxvd01heFNpemUpICogMTAyNCAqIDEwMjQpIHtcbiAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGBQbGVhc2Ugc2VsZWN0IGZpbGUgbGVzcyB0aGFuICR7dGhpcy5hbGxvd01heFNpemV9TUJgO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuICAgICAgaWYgKFxuICAgICAgICAhXy5pc1VuZGVmaW5lZCh0aGlzLmFjY2VwdCkgJiZcbiAgICAgICAgXy5pc1VuZGVmaW5lZChfLmZpbmQodGhpcy52YWxpZF9leHRlbnNpb25zLCBpdGVtID0+IGl0ZW0udG9Mb3dlckNhc2UoKSA9PT0gdGhpcy5nZXRGaWxlRXh0ZW5zaW9uKGZpbGUpLnRvTG93ZXJDYXNlKCkpKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gJ1BsZWFzZSBzZWxlY3QgYSBmaWxlIHdpdGggdmFsaWQgdHlwZSc7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHRoaXMudXBsb2FkKGZpbGUpO1xuICAgIH1cbiAgfVxuXG4gIHVwbG9hZChmaWxlKSB7XG4gICAgY29uc3QgVVBMT0FEX0RJUkVDVElWRV9IRUFERVJTID0gdGhpcy5pbmplY3Rvci5nZXQoJ1VQTE9BRF9ESVJFQ1RJVkVfSEVBREVSUycpO1xuICAgIGNvbnN0IFVQTE9BRF9ESVJFQ1RJVkVfQVBJX1VSTCA9IHRoaXMuaW5qZWN0b3IuZ2V0KCdVUExPQURfRElSRUNUSVZFX0FQSV9VUkwnKTtcblxuICAgIHRoaXMuaXNsb2FkID0gdHJ1ZTtcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWNvbnN0XG4gICAgbGV0ICR0aGlzID0gdGhpcztcbiAgICB0aGlzLmluUHJvZ3Jlc3NbdGhpcy5zdWJQcm9ncmVzc10gPSB0cnVlO1xuICAgIHRoaXMuaW5Qcm9ncmVzc1t0aGlzLnN1YkVycm9yXSA9IGZhbHNlO1xuXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1jb25zdFxuICAgIGxldCBwYXJhbXMgPSB7XG4gICAgICAvLyBmaWxlczogZmlsZVxuICAgICAgdXBsb2FkX3BhdGg6IHRoaXMudXBsb2FkUGF0aFxuICAgIH07XG4gICAgcGFyYW1zW3RoaXMucGFyYW1OYW1lXSA9IGZpbGU7XG4gICAgY29uc3QgcmVxdWVzdEhlYWRlcnMgPSBVUExPQURfRElSRUNUSVZFX0hFQURFUlM7XG4gICAgY29uc3QgcmVxdWVzdEFwaVVybCA9IFVQTE9BRF9ESVJFQ1RJVkVfQVBJX1VSTCArIHRoaXMuYXBpVXBsb2FkO1xuICAgIHRoaXMuYXBpLnVwbG9hZChwYXJhbXMsIHJlcXVlc3RBcGlVcmwsIHJlcXVlc3RIZWFkZXJzKS5zdWJzY3JpYmUoXG4gICAgICByZXNwb25zZSA9PiB7XG4gICAgICAgIHRoaXMuaW5Qcm9ncmVzc1t0aGlzLnN1YlByb2dyZXNzXSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm51bWJlcl9maWxlX3VwbG9hZF9zdWNjZXNzKys7XG4gICAgICAgIGlmICghXy5pc05pbCgkdGhpcy5tdWx0aXBsZSkgJiYgJHRoaXMubXVsdGlwbGUgPT09IHRydWUpIHtcbiAgICAgICAgICBpZiAoISR0aGlzLnpvb20pIHtcbiAgICAgICAgICAgICR0aGlzLmZpbGVMaXN0LnB1c2goJHRoaXMucmVzdWx0VHJhbnNmb3JtZXIocmVzcG9uc2UpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHRoaXMuZmlsZUxpc3QucHVzaCh7IHVybDogJHRoaXMucmVzdWx0VHJhbnNmb3JtZXIocmVzcG9uc2UpLCB1cmxab29tOiAkdGhpcy5yZXN1bHRUcmFuc2Zvcm1lcihyZXNwb25zZSkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgICR0aGlzLnZhbHVlID0gJHRoaXMuZmlsZUxpc3Q7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCEkdGhpcy56b29tKSB7XG4gICAgICAgICAgICAkdGhpcy52YWx1ZSA9ICR0aGlzLnJlc3VsdFRyYW5zZm9ybWVyKHJlc3BvbnNlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHRoaXMudmFsdWUgPSB7IHVybDogJHRoaXMucmVzdWx0VHJhbnNmb3JtZXIocmVzcG9uc2UpLCB1cmxab29tOiAkdGhpcy5yZXN1bHRUcmFuc2Zvcm1lcihyZXNwb25zZSkgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc2xvYWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBudWxsO1xuICAgICAgfSxcbiAgICAgIGVycm9yID0+IHtcbiAgICAgICAgdGhpcy5pc2xvYWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pblByb2dyZXNzW3RoaXMuc3ViUHJvZ3Jlc3NdID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5Qcm9ncmVzc1t0aGlzLnN1YkVycm9yXSA9IHRydWU7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicsIGVycm9yKTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZGVsZXRlSXRlbShpdGVtKSB7XG4gICAgdGhpcy5maWxlTGlzdC5zcGxpY2UodGhpcy5maWxlTGlzdC5pbmRleE9mKGl0ZW0pLCAxKTtcbiAgICB0aGlzLnZhbHVlID0gdGhpcy5maWxlTGlzdDtcbiAgfVxuXG4gIHNob3dEZXRhaWwodmFsKSB7XG4gICAgdGhpcy5pc1Nob3dEZXRhaWwgPSB0cnVlO1xuICAgIHRoaXMudXJsRGV0YWlsID0gdmFsO1xuICB9XG5cbiAgY2xvc2VEZXRhaWwoKSB7XG4gICAgdGhpcy5pc1Nob3dEZXRhaWwgPSBmYWxzZTtcbiAgfVxuXG4gIGlzSW5jbHVkZSh2YWx1ZSwgYXJyKSB7XG4gICAgY29uc3QgYWNjZXB0cyA9IHZhbHVlLnNwbGl0KCd8Jyk7XG4gICAgbGV0IHJlc3VsdCA9IHRydWU7XG4gICAgXy5mb3JFYWNoKGFjY2VwdHMsIGZ1bmN0aW9uKGkpIHtcbiAgICAgIGlmICghXy5maW5kKGFyciwgaXRlbSA9PiBpdGVtID09PSBpKSkge1xuICAgICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG4iXX0=