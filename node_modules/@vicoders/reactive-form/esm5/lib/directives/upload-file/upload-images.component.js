/**
 * @fileoverview added by tsickle
 * Generated from: lib/directives/upload-file/upload-images.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as _ from 'lodash';
import { FileService } from './test';
import { Component, Input, forwardRef, ElementRef, Injector } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { HttpClient } from '@angular/common/http';
import { NgProgress } from '@ngx-progressbar/core';
var UploadFilesComponent = /** @class */ (function () {
    function UploadFilesComponent(injector, api, element, http, progress) {
        var _this = this;
        this.injector = injector;
        this.api = api;
        this.element = element;
        this.http = http;
        this.progress = progress;
        this.inProgress = {
            process: false,
            error: false
        };
        this.number_file_upload_success = 0;
        this.fileList = [];
        this.isload = false;
        this.isShowDetail = false;
        this.imageFormats = ['jpg', 'jpeg', 'png', 'gif', 'djvu', 'raw', 'ico', 'svg', 'tiff', 'bmp'];
        this.documentFormats = ['pdf', 'doc', 'docx', 'xls', 'xlsx', 'txt', 'rtf', 'odt', 'ppt', 'pptx', 'csv', 'xml'];
        this.videoFormats = ['3gp', 'asf', 'avi', 'mov', 'mp4', 'rm', 'vob', 'wmv'];
        this.soundFormats = ['mp3', 'wma', 'wav', 'flac', 'aac', 'ogg', 'aiff', 'alac'];
        this.preventAbuse = false;
        this.getImageDimension = (/**
         * @param {?} imgUrl
         * @return {?}
         */
        function (imgUrl) {
            /** @type {?} */
            var check = true;
            /** @type {?} */
            var img = new Image();
            img.src = imgUrl;
            img.onload = (/**
             * @param {?} event
             * @return {?}
             */
            function (event) {
                /** @type {?} */
                var loadedImage = event.currentTarget;
                /** @type {?} */
                var width = loadedImage.width;
                /** @type {?} */
                var height = loadedImage.height;
                if (!_.isNil(_this.width)) {
                    if (width !== _this.width) {
                        check = false;
                        _this.errorMessage = "*Image width should be equal to " + _this.width + "px";
                    }
                }
                if (!_.isNil(_this.maxWidth)) {
                    if (width > _this.maxWidth) {
                        check = false;
                        _this.errorMessage = "*Image width should be smaller " + _this.maxWidth + "px";
                    }
                }
                if (!_.isNil(_this.height)) {
                    if (height !== _this.height) {
                        check = false;
                        _this.errorMessage = "*Image height should be equal to " + _this.height + "px";
                    }
                }
                if (!_.isNil(_this.maxHeight)) {
                    if (height > _this.maxHeight) {
                        check = false;
                        _this.errorMessage = "*Image height should be smaller " + _this.maxHeight + "px";
                    }
                }
                if (!check) {
                    _this.warning = null;
                }
            });
        });
        this.onChange = (/**
         * @param {?} val
         * @return {?}
         */
        function (val) { });
        this.onTouched = (/**
         * @return {?}
         */
        function () { });
        this.disabled = false;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    UploadFilesComponent.prototype.writeValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val) {
            this.value = val;
        }
    };
    Object.defineProperty(UploadFilesComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._value = val;
            this.onChange(this._value);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} fn
     * @return {?}
     */
    UploadFilesComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    UploadFilesComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouched = fn;
    };
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    UploadFilesComponent.prototype.setDisabledState = /**
     * @param {?} isDisabled
     * @return {?}
     */
    function (isDisabled) {
        this.disabled = isDisabled;
    };
    /**
     * @return {?}
     */
    UploadFilesComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.progressRef = _this.progress.ref('progress-bar-' + _this.id);
            _this.actionRender();
        }), 1);
    };
    /**
     * @param {?} id
     * @return {?}
     */
    UploadFilesComponent.prototype.uploadFile = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        /** @type {?} */
        var $this = this;
        if (this.inProgress['process'] !== true) {
            /** @type {?} */
            var input_1 = document.createElement('input');
            input_1.type = 'file';
            if (!_.isNil(this.multiple) && this.multiple === true) {
                input_1.multiple = true;
            }
            $(input_1).trigger('click');
            $(input_1).on('change', (/**
             * @param {?} event
             * @return {?}
             */
            function (event) {
                _this.number_file_upload_success = 0;
                _this.files = input_1.files;
                if (_this.files.length > 1) {
                    _this.response_data = [];
                    _.forEach(_this.files, (/**
                     * @param {?} file
                     * @return {?}
                     */
                    function (file) {
                        $this.validateFile(file);
                    }));
                }
                if (_this.files.length === 1) {
                    _this.validateFile(_this.files[0]);
                }
            }));
        }
    };
    /**
     * @return {?}
     */
    UploadFilesComponent.prototype.ngOnChanges = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.isClear === true) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                if (!_.isNil(_this.multiple) && _this.multiple === true) {
                    _this.oldValue = [];
                    _this.fileList = [];
                }
                else {
                    _this.oldValue = null;
                }
                /** @type {?} */
                var $this = _this;
                if (!_.isNil(_this.multiple) && _this.multiple === true && !_.isEmpty($this.oldValue)) {
                    _.forEach(_this.oldValue, (/**
                     * @param {?} value
                     * @return {?}
                     */
                    function (value) {
                        $this.fileList.push(value);
                        $this.value = $this.fileList;
                    }));
                }
                else {
                    $this.value = $this.oldValue;
                }
            }), 1);
        }
    };
    /**
     * @return {?}
     */
    UploadFilesComponent.prototype.actionRender = /**
     * @return {?}
     */
    function () {
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        var $this = this;
        this.isload = true;
        if (!_.isNil(this.multiple) && this.multiple === true && !_.isEmpty($this.oldValue)) {
            _.forEach(this.oldValue, (/**
             * @param {?} value
             * @return {?}
             */
            function (value) {
                $this.fileList.push(value);
                $this.value = $this.fileList;
            }));
        }
        else {
            $this.value = $this.oldValue;
        }
        this.isload = false;
        if (!_.isUndefined(this.accept)) {
            this.valid_extensions = this.accept.split('|');
        }
        // $('#uploadfile_v2-reactive-form-' + this.id).click(() => {
        //   console.log(this.inProgress);
        //   if (this.inProgress['process'] !== true) {
        //     const input = document.createElement('input');
        //     input.type = 'file';
        //     if (!_.isNil(this.multiple) && this.multiple === true) {
        //       input.multiple = true;
        //     }
        //     $(input).trigger('click');
        //     $(input).on('change', event => {
        //       this.number_file_upload_success = 0;
        //       this.files = input.files;
        //       if (this.files.length > 1) {
        //         this.response_data = [];
        //         _.forEach(this.files, function(file) {
        //           $this.validateFile(file);
        //         });
        //       }
        //       if (this.files.length === 1) {
        //         this.validateFile(this.files[0]);
        //       }
        //     });
        //   }
        // });
    };
    /**
     * @return {?}
     */
    UploadFilesComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (!_.isNil(this.maxWidth)) {
            this.warning = "*The image width should be smaller " + this.maxWidth;
        }
        if (!_.isNil(this.maxHeight)) {
            this.warning = "*The image width should be smaller " + this.maxHeight;
        }
        if (!_.isNil(this.width) && !_.isNil(this.height)) {
            this.warning = "*Recommended size: " + this.width + "x" + this.height;
        }
        else {
            if (!_.isNil(this.width)) {
                this.warning = "*Recommended width: " + this.width;
            }
            if (!_.isNil(this.height)) {
                this.warning = "*Recommended height: " + this.height;
            }
        }
    };
    /**
     * @param {?} file
     * @return {?}
     */
    UploadFilesComponent.prototype.getFileExtension = /**
     * @param {?} file
     * @return {?}
     */
    function (file) {
        return file.name.split('.').pop();
    };
    /**
     * @param {?} file
     * @return {?}
     */
    UploadFilesComponent.prototype.validateFile = /**
     * @param {?} file
     * @return {?}
     */
    function (file) {
        var _this = this;
        if (file !== undefined) {
            if (!_.isNil(this.allowMaxSize) && this.allowMaxSize !== '') {
                if (file.size > parseFloat(this.allowMaxSize) * 1024 * 1024) {
                    this.errorMessage = "Please select file less than " + this.allowMaxSize + "MB";
                    return false;
                }
            }
            // tslint:disable-next-line:max-line-length
            if (!_.isUndefined(this.accept) &&
                _.isUndefined(_.find(this.valid_extensions, (/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.toLowerCase() === _this.getFileExtension(file).toLowerCase(); })))) {
                this.errorMessage = 'Please select a file with valid type';
                return false;
            }
            this.upload(file);
        }
    };
    /**
     * @param {?} file
     * @return {?}
     */
    UploadFilesComponent.prototype.upload = /**
     * @param {?} file
     * @return {?}
     */
    function (file) {
        var _this = this;
        this.preventAbuse = true;
        this.progressRef.start();
        /** @type {?} */
        var UPLOAD_DIRECTIVE_HEADERS = this.injector.get('UPLOAD_DIRECTIVE_HEADERS');
        /** @type {?} */
        var UPLOAD_DIRECTIVE_API_URL = this.injector.get('UPLOAD_DIRECTIVE_API_URL');
        this.isload = true;
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        var $this = this;
        this.inProgress['process'] = true;
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        var params = {
            // files: file
            upload_path: this.uploadPath
        };
        params[this.paramName] = file;
        /** @type {?} */
        var requestHeaders = UPLOAD_DIRECTIVE_HEADERS;
        /** @type {?} */
        var requestApiUrl = UPLOAD_DIRECTIVE_API_URL + this.apiUpload;
        this.api.upload(params, requestApiUrl, requestHeaders).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        function (response) {
            // setTimeout(() => {
            _this.progressRef.complete();
            _this.inProgress['process'] = false;
            _this.number_file_upload_success++;
            if (!_.isNil($this.multiple) && $this.multiple === true) {
                $this.fileList.push($this.resultTransformer(response));
                $this.value = $this.fileList;
            }
            else {
                $this.value = $this.resultTransformer(response);
                if (response) {
                    if (!_.isNil($this.width) || !_.isNil($this.height) || !_.isNil($this.maxWidth) || !_.isNil($this.maxHeight)) {
                        $this.getImageDimension(response.data[0].full_path);
                    }
                }
            }
            _this.isload = false;
            _this.errorMessage = null;
            _this.preventAbuse = false;
            // }, 800);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.isload = false;
            _this.inProgress['process'] = false;
            console.log('error', error);
            _this.errorMessage = error.message;
            _this.progressRef.complete();
        }));
    };
    /**
     * @param {?} item
     * @return {?}
     */
    UploadFilesComponent.prototype.deleteItem = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        if (this.multiple === true) {
            this.fileList.splice(this.fileList.indexOf(item), 1);
            this.value = this.fileList;
        }
        else {
            this.value = null;
        }
    };
    /**
     * @param {?} value
     * @param {?} arr
     * @return {?}
     */
    UploadFilesComponent.prototype.isInclude = /**
     * @param {?} value
     * @param {?} arr
     * @return {?}
     */
    function (value, arr) {
        /** @type {?} */
        var accepts = value.split('|');
        /** @type {?} */
        var result = true;
        _.forEach(accepts, (/**
         * @param {?} i
         * @return {?}
         */
        function (i) {
            if (!_.find(arr, (/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item === i; }))) {
                result = false;
            }
        }));
        return result;
    };
    /**
     * @param {?} accepts
     * @return {?}
     */
    UploadFilesComponent.prototype.getIcon = /**
     * @param {?} accepts
     * @return {?}
     */
    function (accepts) {
        /** @type {?} */
        var $this = this;
        accepts = accepts.split('|');
        /** @type {?} */
        var result = 'fa-exclamation-triangle';
        _.forEach(accepts, (/**
         * @param {?} i
         * @return {?}
         */
        function (i) {
            if (_.find($this.documentFormats, (/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item === i; }))) {
                result = 'fa-file-text-o';
            }
            if (_.find($this.videoFormats, (/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item === i; }))) {
                result = 'fa-file-video-o';
            }
            if (_.find($this.soundFormats, (/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item === i; }))) {
                result = 'fa-file-audio-o';
            }
        }));
        return result;
    };
    /**
     * @return {?}
     */
    UploadFilesComponent.prototype.okok = /**
     * @return {?}
     */
    function () {
        this.dataFunction();
    };
    UploadFilesComponent.decorators = [
        { type: Component, args: [{
                    // tslint:disable-next-line:component-selector
                    selector: 'upload-file',
                    template: "<div class=\"row\" *ngIf=\"isInclude(accept, imageFormats)\">\n  <div class=\"col-md-12 form-wrapper\" style=\"margin-bottom: 15px;\">\n    <div class=\"signle-img zoom-effect-container\" *ngIf=\"!multiple || multiple === false\">\n      <div class=\"rf__ulf_preview_content image-card\">\n        <a *ngIf=\"value\" href=\"{{ value }}\" target=\"_blank\">\n          <img\n            [ngStyle]=\"{\n              'background-image': 'url(' + value + ')',\n              'background-position': 'center',\n              'background-repeat': 'no-repeat',\n              'background-size': 'cover'\n            }\"\n            src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlEMjQ4QkVCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTlEMjQ4Q0VCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5OUQyNDg5RUJCRTExRThCRDY3OURGRUFDRDA0RTREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY5OUQyNDhBRUJCRTExRThCRDY3OURGRUFDRDA0RTREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+O7rz2AAAASBJREFUeNrs0jERAAAIxDDAv+fHACNjIqHXTlLwbSTAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsuK0AAwBL0gQp9PLLgwAAAABJRU5ErkJggg==\"\n            width=\"100\"\n            alt=\"\"\n          />\n          <i title=\"remove\" (click)=\"deleteItem(value); (false)\" class=\"fa fa-trash-o rf__remove\" aria-hidden=\"true\"></i>\n        </a>\n      </div>\n      <p *ngIf=\"warning\" class=\"warning\">{{ warning }}</p>\n      <ng-progress color=\"#92c34e\" id=\"progress-bar-{{ id }}\" fixed=\"false\" spinnerPosition=\"left\"></ng-progress>\n      <button\n        (click)=\"uploadFile(id)\"\n        [ngClass]=\"{ waitting: preventAbuse }\"\n        type=\"button\"\n        *ngIf=\"multiple === false || !multiple\"\n        id=\"uploadfile_v2-reactive-form-{{ id }}\"\n        class=\"chip\"\n        [disabled]=\"preventAbuse\"\n      >\n        <span [innerHTML]=\"preventAbuse ? 'Wait...' : (title | noSanitize)\"></span>\n      </button>\n      <button type=\"button\" class=\"chip\" *ngIf=\"uploadFromDB\" (click)=\"okok()\">Choose</button>\n    </div>\n    <div class=\"rf__ulf_content\" *ngIf=\"multiple === true\">\n      <div class=\"mutil-img\">\n        <ng-progress color=\"#92c34e\" id=\"progress-bar-{{ id }}\" fixed=\"false\" spinnerPosition=\"left\"></ng-progress>\n        <div class=\"group-item zoom-effect-container-multi\" *ngFor=\"let item of value\">\n          <div class=\"image-card\">\n            <a href=\"{{ item }}\" target=\"_blank\">\n              <img\n                [ngStyle]=\"{\n                  'background-image': 'url(' + item + ')',\n                  'background-position': 'center',\n                  'background-repeat': 'no-repeat',\n                  'background-size': 'cover'\n                }\"\n                class=\"singleImg\"\n                alt=\"\"\n                src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlEMjQ4QkVCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTlEMjQ4Q0VCQkUxMUU4QkQ2NzlERkVBQ0QwNEU0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5OUQyNDg5RUJCRTExRThCRDY3OURGRUFDRDA0RTREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY5OUQyNDhBRUJCRTExRThCRDY3OURGRUFDRDA0RTREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+O7rz2AAAASBJREFUeNrs0jERAAAIxDDAv+fHACNjIqHXTlLwbSTAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsMBbGwlhgLIyFscBYGAtjgbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFsYCY2EsjAXGwlgYC4yFsTAWGAtjYSwwFsbCWGAsjIWxwFgYC2OBsTAWxgJjYSyMBcbCWBgLjIWxMBYYC2NhLDAWxsJYYCyMhbHAWBgLY4GxMBbGAmNhLIwFxsJYGAuMhbEwFhgLY2EsuK0AAwBL0gQp9PLLgwAAAABJRU5ErkJggg==\"\n              />\n            </a>\n          </div>\n\n          <span title=\"Remove\" (click)=\"deleteItem(item)\"><i class=\"fa fa-trash-o\" aria-hidden=\"true\"></i></span>\n        </div>\n      </div>\n      <button\n        (click)=\"uploadFile(id)\"\n        [ngClass]=\"{ waitting: preventAbuse }\"\n        type=\"button\"\n        *ngIf=\"multiple === true\"\n        id=\"uploadfile_v2-reactive-form-{{ id }}\"\n        class=\"chip\"\n        [disabled]=\"preventAbuse\"\n      >\n        <span [innerHTML]=\"preventAbuse ? 'Wait...' : (title | noSanitize)\"></span>\n      </button>\n      <button type=\"button\" class=\"chip\" *ngIf=\"uploadFromDB\" (click)=\"okok()\">Choose</button>\n      <!-- <div class=\"loader-img add-icon\" *ngIf=\"isload\"></div>\n      <div id=\"uploadfile_v2-reactive-form-{{ id }}\" class=\"plus icon add-icon\"></div> -->\n    </div>\n  </div>\n</div>\n\n<div class=\"row\" *ngIf=\"!isInclude(accept, imageFormats)\">\n  <div class=\"col-md-12\" style=\"margin-bottom: 15px;\">\n    <div class=\"rf_uld_preview\" *ngIf=\"!multiple || multiple === false\">\n      <div class=\"form-group\" *ngIf=\"value\">\n        <p>\n          <i class=\"fa {{ getIcon(accept) }}\" aria-hidden=\"true\"></i> {{ value }}\n          <i (click)=\"deleteItem(value); (false)\" class=\"fa fa-trash-o\" aria-hidden=\"true\"></i>\n        </p>\n      </div>\n      <ng-progress color=\"#92c34e\" id=\"progress-bar-{{ id }}\" fixed=\"false\" spinnerPosition=\"left\"></ng-progress>\n    </div>\n    <div class=\"mutil-img rf_uld_preview  rf_uld_preview-multil\" *ngIf=\"multiple === true\">\n      <ng-progress color=\"#92c34e\" id=\"progress-bar-{{ id }}\" fixed=\"false\" spinnerPosition=\"left\"></ng-progress>\n      <div class=\"form-group\" *ngFor=\"let item of value\">\n        <p>\n          <i class=\"fa {{ getIcon(accept) }}\" aria-hidden=\"true\"></i> {{ item\n          }}<i (click)=\"deleteItem(item)\" class=\"fa fa-trash-o\" aria-hidden=\"true\"></i>\n        </p>\n      </div>\n    </div>\n    <div class=\"form-group\">\n      <button\n        (click)=\"uploadFile(id)\"\n        [ngClass]=\"{ waitting: preventAbuse }\"\n        type=\"button\"\n        id=\"uploadfile_v2-reactive-form-{{ id }}\"\n        class=\"chip\"\n        [disabled]=\"preventAbuse\"\n      >\n        <span [innerHTML]=\"preventAbuse ? 'Wait...' : (title | noSanitize)\"></span>\n      </button>\n    </div>\n  </div>\n</div>\n\n<div *ngIf=\"errorMessage\" class=\"error-message\">{{ errorMessage }}</div>\n",
                    providers: [
                        FileService,
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef((/**
                             * @return {?}
                             */
                            function () { return UploadFilesComponent; })),
                            multi: true
                        }
                    ],
                    styles: [".form-wrapper{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}img{cursor:pointer}.chip{box-sizing:border-box;margin:15px 0 1em;border-radius:1.5em;padding:.6em 1em;font-size:.8em;width:136px;text-align:center;border:none;background-color:#92c34e;color:#fff;cursor:pointer}ng-progress{position:absolute;top:0;left:0;right:0}.error-message{color:red}.btn-upload-file{position:relative}.btn-upload-file .add-icon{position:absolute;right:-50px;top:0}.fa-times{margin-left:15px;cursor:pointer;color:#cd5c5c}.waitting{background:#ecf0f1}.form-wrapper .signle-img{text-align:center;position:relative;overflow:hidden;width:150px}.form-wrapper .signle-img .rf__ulf_preview_content{width:150xp;min-height:150px;background-color:#ecf0f1}.form-wrapper .signle-img img{width:100%}.form-wrapper .signle-img .rf__ulf_preview_content a .rf__remove{position:absolute;top:5px;right:5px}.rf__ulf_content{width:100%}.mutil-img .group-item{display:inline-block;position:relative;margin-right:10px;margin-bottom:30px}.mutil-img .group-item span{position:absolute;left:50%;bottom:-25px;margin-left:-25px;cursor:pointer;font-size:14px}.mutil-img .group-item span:hover{text-decoration:underline;color:grey}.form-wrapper .mutil-img{display:-webkit-box;display:flex;flex-wrap:wrap;-webkit-box-align:center;align-items:center;width:100%;min-height:200px;background-color:#d3d3d3;padding:10px;position:relative;overflow:hidden;-webkit-transition:.4s;transition:.4s}.form-wrapper .mutil-img img{width:100%;border-radius:10px}.image-card img{-webkit-transition:.4s;transition:.4s}.zoom-effect-container-multi:hover .image-card img,.zoom-effect-container:hover .image-card img{-webkit-transform:scale(1.08);transform:scale(1.08)}.zoom-effect-container-multi .image-card img{-webkit-transition:.4s;transition:.4s}.rf_uld_preview{width:100%;min-height:50px;background-color:#ecf0f1;padding:10px;position:relative;overflow:hidden}.rf_uld_preview .fa-file-text-o,.rf_uld_preview .form-group,.rf_uld_preview .form-group p{margin:0}.rf_uld_preview .form-group p{border-radius:10px;padding:5px 10px;background-color:#bdc3c7;font-size:14px}.rf_uld_preview-multil .form-group p{margin-bottom:10px}.warning{color:gray;margin-bottom:10px;margin-top:10px;font-size:11px}"]
                }] }
    ];
    /** @nocollapse */
    UploadFilesComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: FileService },
        { type: ElementRef },
        { type: HttpClient },
        { type: NgProgress }
    ]; };
    UploadFilesComponent.propDecorators = {
        id: [{ type: Input }],
        headers: [{ type: Input }],
        apiUpload: [{ type: Input }],
        accept: [{ type: Input }],
        allowMaxSize: [{ type: Input }],
        uploadPath: [{ type: Input }],
        multiple: [{ type: Input }],
        _value: [{ type: Input }],
        resultTransformer: [{ type: Input }],
        paramName: [{ type: Input }],
        oldValue: [{ type: Input }],
        isClear: [{ type: Input }],
        title: [{ type: Input }],
        dataFunction: [{ type: Input }],
        uploadFromDB: [{ type: Input }],
        width: [{ type: Input }],
        maxWidth: [{ type: Input }],
        height: [{ type: Input }],
        maxHeight: [{ type: Input }]
    };
    return UploadFilesComponent;
}());
export { UploadFilesComponent };
if (false) {
    /** @type {?} */
    UploadFilesComponent.prototype.id;
    /** @type {?} */
    UploadFilesComponent.prototype.headers;
    /** @type {?} */
    UploadFilesComponent.prototype.apiUpload;
    /** @type {?} */
    UploadFilesComponent.prototype.accept;
    /** @type {?} */
    UploadFilesComponent.prototype.allowMaxSize;
    /** @type {?} */
    UploadFilesComponent.prototype.uploadPath;
    /** @type {?} */
    UploadFilesComponent.prototype.multiple;
    /** @type {?} */
    UploadFilesComponent.prototype._value;
    /** @type {?} */
    UploadFilesComponent.prototype.resultTransformer;
    /** @type {?} */
    UploadFilesComponent.prototype.paramName;
    /** @type {?} */
    UploadFilesComponent.prototype.oldValue;
    /** @type {?} */
    UploadFilesComponent.prototype.isClear;
    /** @type {?} */
    UploadFilesComponent.prototype.title;
    /** @type {?} */
    UploadFilesComponent.prototype.dataFunction;
    /** @type {?} */
    UploadFilesComponent.prototype.uploadFromDB;
    /** @type {?} */
    UploadFilesComponent.prototype.width;
    /** @type {?} */
    UploadFilesComponent.prototype.maxWidth;
    /** @type {?} */
    UploadFilesComponent.prototype.height;
    /** @type {?} */
    UploadFilesComponent.prototype.maxHeight;
    /** @type {?} */
    UploadFilesComponent.prototype.inProgress;
    /** @type {?} */
    UploadFilesComponent.prototype.files;
    /** @type {?} */
    UploadFilesComponent.prototype.number_file_upload_success;
    /** @type {?} */
    UploadFilesComponent.prototype.response_data;
    /** @type {?} */
    UploadFilesComponent.prototype.valid_extensions;
    /** @type {?} */
    UploadFilesComponent.prototype.fileList;
    /** @type {?} */
    UploadFilesComponent.prototype.isload;
    /** @type {?} */
    UploadFilesComponent.prototype.isShowDetail;
    /** @type {?} */
    UploadFilesComponent.prototype.errorMessage;
    /** @type {?} */
    UploadFilesComponent.prototype.warning;
    /** @type {?} */
    UploadFilesComponent.prototype.imageFormats;
    /** @type {?} */
    UploadFilesComponent.prototype.documentFormats;
    /** @type {?} */
    UploadFilesComponent.prototype.videoFormats;
    /** @type {?} */
    UploadFilesComponent.prototype.soundFormats;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.disabled;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.onChange;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.onTouched;
    /** @type {?} */
    UploadFilesComponent.prototype.preventAbuse;
    /** @type {?} */
    UploadFilesComponent.prototype.progressRef;
    /** @type {?} */
    UploadFilesComponent.prototype.getImageDimension;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.api;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.element;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    UploadFilesComponent.prototype.progress;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXBsb2FkLWltYWdlcy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Admljb2RlcnMvcmVhY3RpdmUtZm9ybS8iLCJzb3VyY2VzIjpbImxpYi9kaXJlY3RpdmVzL3VwbG9hZC1maWxlL3VwbG9hZC1pbWFnZXMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxLQUFLLENBQUMsTUFBTSxRQUFRLENBQUM7QUFDNUIsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUVyQyxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUE0QixRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDckgsT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsVUFBVSxFQUFpQixNQUFNLHVCQUF1QixDQUFDO0FBRWxFO0lBMERFLDhCQUNVLFFBQWtCLEVBQ2xCLEdBQWdCLEVBQ2hCLE9BQW1CLEVBQ25CLElBQWdCLEVBQ2hCLFFBQW9CO1FBTDlCLGlCQVVDO1FBVFMsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNsQixRQUFHLEdBQUgsR0FBRyxDQUFhO1FBQ2hCLFlBQU8sR0FBUCxPQUFPLENBQVk7UUFDbkIsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUNoQixhQUFRLEdBQVIsUUFBUSxDQUFZO1FBNUI5QixlQUFVLEdBQVE7WUFDaEIsT0FBTyxFQUFFLEtBQUs7WUFDZCxLQUFLLEVBQUUsS0FBSztTQUNiLENBQUM7UUFFRiwrQkFBMEIsR0FBRyxDQUFDLENBQUM7UUFHL0IsYUFBUSxHQUFHLEVBQUUsQ0FBQztRQUNkLFdBQU0sR0FBRyxLQUFLLENBQUM7UUFDZixpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUdyQixpQkFBWSxHQUFHLENBQUMsS0FBSyxFQUFFLE1B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Q0FBUTs7SUFDUiw0Q0FBeUY7O0lBQ3pGLCtDQUEwRzs7SUFDMUcsNENBQXVFOztJQUN2RSw0Q0FBMkU7Ozs7O0lBQzNFLHdDQUEwQjs7Ozs7SUFDMUIsd0NBQTJCOzs7OztJQUMzQix5Q0FBNEI7O0lBRTVCLDRDQUFxQjs7SUFDckIsMkNBQTJCOztJQXVPM0IsaURBb0NDOzs7OztJQXpRQyx3Q0FBMEI7Ozs7O0lBQzFCLG1DQUF3Qjs7Ozs7SUFDeEIsdUNBQTJCOzs7OztJQUMzQixvQ0FBd0I7Ozs7O0lBQ3hCLHdDQUE0QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IEZpbGVTZXJ2aWNlIH0gZnJvbSAnLi90ZXN0JztcbmRlY2xhcmUgY29uc3QgJDogYW55O1xuaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBmb3J3YXJkUmVmLCBFbGVtZW50UmVmLCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIEluamVjdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgTmdQcm9ncmVzcywgTmdQcm9ncmVzc1JlZiB9IGZyb20gJ0BuZ3gtcHJvZ3Jlc3NiYXIvY29yZSc7XG5cbkBDb21wb25lbnQoe1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gIHNlbGVjdG9yOiAndXBsb2FkLWZpbGUnLFxuICB0ZW1wbGF0ZVVybDogJy4vdXBsb2FkLWltYWdlcy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3VwbG9hZC1pbWFnZXMuY29tcG9uZW50LmNzcyddLFxuICBwcm92aWRlcnM6IFtcbiAgICBGaWxlU2VydmljZSxcbiAgICB7XG4gICAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFVwbG9hZEZpbGVzQ29tcG9uZW50KSxcbiAgICAgIG11bHRpOiB0cnVlXG4gICAgfVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIFVwbG9hZEZpbGVzQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBDb250cm9sVmFsdWVBY2Nlc3NvciwgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzIHtcbiAgQElucHV0KCkgaWQ6IG51bWJlcjtcbiAgQElucHV0KCkgaGVhZGVyczogc3RyaW5nO1xuICBASW5wdXQoKSBhcGlVcGxvYWQ6IHN0cmluZztcbiAgQElucHV0KCkgYWNjZXB0OiBzdHJpbmc7XG4gIEBJbnB1dCgpIGFsbG93TWF4U2l6ZTogYW55O1xuICBASW5wdXQoKSB1cGxvYWRQYXRoOiBhbnk7XG4gIEBJbnB1dCgpIG11bHRpcGxlOiBCb29sZWFuO1xuICBASW5wdXQoKSBfdmFsdWU7XG4gIEBJbnB1dCgpIHJlc3VsdFRyYW5zZm9ybWVyO1xuICBASW5wdXQoKSBwYXJhbU5hbWU7XG4gIEBJbnB1dCgpIG9sZFZhbHVlO1xuICBASW5wdXQoKSBpc0NsZWFyOiBCb29sZWFuO1xuICBASW5wdXQoKSB0aXRsZTogc3RyaW5nO1xuICBASW5wdXQoKSBkYXRhRnVuY3Rpb246IEZ1bmN0aW9uO1xuICBASW5wdXQoKSB1cGxvYWRGcm9tREI6IGJvb2xlYW47XG4gIEBJbnB1dCgpIHdpZHRoOiBzdHJpbmc7XG4gIEBJbnB1dCgpIG1heFdpZHRoOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGhlaWdodDogc3RyaW5nO1xuICBASW5wdXQoKSBtYXhIZWlnaHQ6IHN0cmluZztcblxuICBpblByb2dyZXNzOiBhbnkgPSB7XG4gICAgcHJvY2VzczogZmFsc2UsXG4gICAgZXJyb3I6IGZhbHNlXG4gIH07XG4gIGZpbGVzO1xuICBudW1iZXJfZmlsZV91cGxvYWRfc3VjY2VzcyA9IDA7XG4gIHJlc3BvbnNlX2RhdGE7XG4gIHZhbGlkX2V4dGVuc2lvbnM7XG4gIGZpbGVMaXN0ID0gW107XG4gIGlzbG9hZCA9IGZhbHNlO1xuICBpc1Nob3dEZXRhaWwgPSBmYWxzZTtcbiAgZXJyb3JNZXNzYWdlO1xuICB3YXJuaW5nO1xuICBpbWFnZUZvcm1hdHMgPSBbJ2pwZycsICdqcGVnJywgJ3BuZycsICdnaWYnLCAnZGp2dScsICdyYXcnLCAnaWNvJywgJ3N2ZycsICd0aWZmJywgJ2JtcCddO1xuICBkb2N1bWVudEZvcm1hdHMgPSBbJ3BkZicsICdkb2MnLCAnZG9jeCcsICd4bHMnLCAneGxzeCcsICd0eHQnLCAncnRmJywgJ29kdCcsICdwcHQnLCAncHB0eCcsICdjc3YnLCAneG1sJ107XG4gIHZpZGVvRm9ybWF0cyA9IFsnM2dwJywgJ2FzZicsICdhdmknLCAnbW92JywgJ21wNCcsICdybScsICd2b2InLCAnd212J107XG4gIHNvdW5kRm9ybWF0cyA9IFsnbXAzJywgJ3dtYScsICd3YXYnLCAnZmxhYycsICdhYWMnLCAnb2dnJywgJ2FpZmYnLCAnYWxhYyddO1xuICBwcml2YXRlIGRpc2FibGVkOiBib29sZWFuO1xuICBwcml2YXRlIG9uQ2hhbmdlOiBGdW5jdGlvbjtcbiAgcHJpdmF0ZSBvblRvdWNoZWQ6IEZ1bmN0aW9uO1xuXG4gIHByZXZlbnRBYnVzZSA9IGZhbHNlO1xuICBwcm9ncmVzc1JlZjogTmdQcm9ncmVzc1JlZjtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXG4gICAgcHJpdmF0ZSBhcGk6IEZpbGVTZXJ2aWNlLFxuICAgIHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZixcbiAgICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQsXG4gICAgcHJpdmF0ZSBwcm9ncmVzczogTmdQcm9ncmVzc1xuICApIHtcbiAgICB0aGlzLm9uQ2hhbmdlID0gKHZhbDogYW55KSA9PiB7IH07XG4gICAgdGhpcy5vblRvdWNoZWQgPSAoKSA9PiB7IH07XG4gICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgd3JpdGVWYWx1ZSh2YWw6IGFueSk6IHZvaWQge1xuICAgIGlmICh2YWwpIHtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWw7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgfVxuXG4gIHNldCB2YWx1ZSh2YWwpIHtcbiAgICB0aGlzLl92YWx1ZSA9IHZhbDtcbiAgICB0aGlzLm9uQ2hhbmdlKHRoaXMuX3ZhbHVlKTtcbiAgfVxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLm9uQ2hhbmdlID0gZm47XG4gIH1cblxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KTogdm9pZCB7XG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5wcm9ncmVzc1JlZiA9IHRoaXMucHJvZ3Jlc3MucmVmKCdwcm9ncmVzcy1iYXItJyArIHRoaXMuaWQpO1xuICAgICAgdGhpcy5hY3Rpb25SZW5kZXIoKTtcbiAgICB9LCAxKTtcbiAgfVxuXG4gIHVwbG9hZEZpbGUoaWQpIHtcbiAgICBjb25zdCAkdGhpcyA9IHRoaXM7XG4gICAgaWYgKHRoaXMuaW5Qcm9ncmVzc1sncHJvY2VzcyddICE9PSB0cnVlKSB7XG4gICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICBpbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAgICAgaWYgKCFfLmlzTmlsKHRoaXMubXVsdGlwbGUpICYmIHRoaXMubXVsdGlwbGUgPT09IHRydWUpIHtcbiAgICAgICAgaW5wdXQubXVsdGlwbGUgPSB0cnVlO1xuICAgICAgfVxuICAgICAgJChpbnB1dCkudHJpZ2dlcignY2xpY2snKTtcbiAgICAgICQoaW5wdXQpLm9uKCdjaGFuZ2UnLCBldmVudCA9PiB7XG4gICAgICAgIHRoaXMubnVtYmVyX2ZpbGVfdXBsb2FkX3N1Y2Nlc3MgPSAwO1xuICAgICAgICB0aGlzLmZpbGVzID0gaW5wdXQuZmlsZXM7XG4gICAgICAgIGlmICh0aGlzLmZpbGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICB0aGlzLnJlc3BvbnNlX2RhdGEgPSBbXTtcbiAgICAgICAgICBfLmZvckVhY2godGhpcy5maWxlcywgZnVuY3Rpb24gKGZpbGUpIHtcbiAgICAgICAgICAgICR0aGlzLnZhbGlkYXRlRmlsZShmaWxlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWxlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICB0aGlzLnZhbGlkYXRlRmlsZSh0aGlzLmZpbGVzWzBdKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkNoYW5nZXMoKSB7XG4gICAgaWYgKHRoaXMuaXNDbGVhciA9PT0gdHJ1ZSkge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmICghXy5pc05pbCh0aGlzLm11bHRpcGxlKSAmJiB0aGlzLm11bHRpcGxlID09PSB0cnVlKSB7XG4gICAgICAgICAgdGhpcy5vbGRWYWx1ZSA9IFtdO1xuICAgICAgICAgIHRoaXMuZmlsZUxpc3QgPSBbXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm9sZFZhbHVlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCAkdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghXy5pc05pbCh0aGlzLm11bHRpcGxlKSAmJiB0aGlzLm11bHRpcGxlID09PSB0cnVlICYmICFfLmlzRW1wdHkoJHRoaXMub2xkVmFsdWUpKSB7XG4gICAgICAgICAgXy5mb3JFYWNoKHRoaXMub2xkVmFsdWUsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgJHRoaXMuZmlsZUxpc3QucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAkdGhpcy52YWx1ZSA9ICR0aGlzLmZpbGVMaXN0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICR0aGlzLnZhbHVlID0gJHRoaXMub2xkVmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0sIDEpO1xuICAgIH1cbiAgfVxuXG4gIGFjdGlvblJlbmRlcigpIHtcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWNvbnN0XG4gICAgbGV0ICR0aGlzID0gdGhpcztcbiAgICB0aGlzLmlzbG9hZCA9IHRydWU7XG4gICAgaWYgKCFfLmlzTmlsKHRoaXMubXVsdGlwbGUpICYmIHRoaXMubXVsdGlwbGUgPT09IHRydWUgJiYgIV8uaXNFbXB0eSgkdGhpcy5vbGRWYWx1ZSkpIHtcbiAgICAgIF8uZm9yRWFjaCh0aGlzLm9sZFZhbHVlLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgJHRoaXMuZmlsZUxpc3QucHVzaCh2YWx1ZSk7XG4gICAgICAgICR0aGlzLnZhbHVlID0gJHRoaXMuZmlsZUxpc3Q7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHRoaXMudmFsdWUgPSAkdGhpcy5vbGRWYWx1ZTtcbiAgICB9XG4gICAgdGhpcy5pc2xvYWQgPSBmYWxzZTtcblxuICAgIGlmICghXy5pc1VuZGVmaW5lZCh0aGlzLmFjY2VwdCkpIHtcbiAgICAgIHRoaXMudmFsaWRfZXh0ZW5zaW9ucyA9IHRoaXMuYWNjZXB0LnNwbGl0KCd8Jyk7XG4gICAgfVxuXG4gICAgLy8gJCgnI3VwbG9hZGZpbGVfdjItcmVhY3RpdmUtZm9ybS0nICsgdGhpcy5pZCkuY2xpY2soKCkgPT4ge1xuICAgIC8vICAgY29uc29sZS5sb2codGhpcy5pblByb2dyZXNzKTtcbiAgICAvLyAgIGlmICh0aGlzLmluUHJvZ3Jlc3NbJ3Byb2Nlc3MnXSAhPT0gdHJ1ZSkge1xuICAgIC8vICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgLy8gICAgIGlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgLy8gICAgIGlmICghXy5pc05pbCh0aGlzLm11bHRpcGxlKSAmJiB0aGlzLm11bHRpcGxlID09PSB0cnVlKSB7XG4gICAgLy8gICAgICAgaW5wdXQubXVsdGlwbGUgPSB0cnVlO1xuICAgIC8vICAgICB9XG4gICAgLy8gICAgICQoaW5wdXQpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgLy8gICAgICQoaW5wdXQpLm9uKCdjaGFuZ2UnLCBldmVudCA9PiB7XG4gICAgLy8gICAgICAgdGhpcy5udW1iZXJfZmlsZV91cGxvYWRfc3VjY2VzcyA9IDA7XG4gICAgLy8gICAgICAgdGhpcy5maWxlcyA9IGlucHV0LmZpbGVzO1xuICAgIC8vICAgICAgIGlmICh0aGlzLmZpbGVzLmxlbmd0aCA+IDEpIHtcbiAgICAvLyAgICAgICAgIHRoaXMucmVzcG9uc2VfZGF0YSA9IFtdO1xuICAgIC8vICAgICAgICAgXy5mb3JFYWNoKHRoaXMuZmlsZXMsIGZ1bmN0aW9uKGZpbGUpIHtcbiAgICAvLyAgICAgICAgICAgJHRoaXMudmFsaWRhdGVGaWxlKGZpbGUpO1xuICAgIC8vICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgfVxuICAgIC8vICAgICAgIGlmICh0aGlzLmZpbGVzLmxlbmd0aCA9PT0gMSkge1xuICAgIC8vICAgICAgICAgdGhpcy52YWxpZGF0ZUZpbGUodGhpcy5maWxlc1swXSk7XG4gICAgLy8gICAgICAgfVxuICAgIC8vICAgICB9KTtcbiAgICAvLyAgIH1cbiAgICAvLyB9KTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGlmICghXy5pc05pbCh0aGlzLm1heFdpZHRoKSkge1xuICAgICAgdGhpcy53YXJuaW5nID0gYCpUaGUgaW1hZ2Ugd2lkdGggc2hvdWxkIGJlIHNtYWxsZXIgJHt0aGlzLm1heFdpZHRofWA7XG4gICAgfVxuICAgIGlmICghXy5pc05pbCh0aGlzLm1heEhlaWdodCkpIHtcbiAgICAgIHRoaXMud2FybmluZyA9IGAqVGhlIGltYWdlIHdpZHRoIHNob3VsZCBiZSBzbWFsbGVyICR7dGhpcy5tYXhIZWlnaHR9YDtcbiAgICB9XG4gICAgaWYgKCFfLmlzTmlsKHRoaXMud2lkdGgpICYmICFfLmlzTmlsKHRoaXMuaGVpZ2h0KSkge1xuICAgICAgdGhpcy53YXJuaW5nID0gYCpSZWNvbW1lbmRlZCBzaXplOiAke3RoaXMud2lkdGh9eCR7dGhpcy5oZWlnaHR9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFfLmlzTmlsKHRoaXMud2lkdGgpKSB7XG4gICAgICAgIHRoaXMud2FybmluZyA9IGAqUmVjb21tZW5kZWQgd2lkdGg6ICR7dGhpcy53aWR0aH1gO1xuICAgICAgfVxuICAgICAgaWYgKCFfLmlzTmlsKHRoaXMuaGVpZ2h0KSkge1xuICAgICAgICB0aGlzLndhcm5pbmcgPSBgKlJlY29tbWVuZGVkIGhlaWdodDogJHt0aGlzLmhlaWdodH1gO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldEZpbGVFeHRlbnNpb24oZmlsZSkge1xuICAgIHJldHVybiBmaWxlLm5hbWUuc3BsaXQoJy4nKS5wb3AoKTtcbiAgfVxuXG4gIHZhbGlkYXRlRmlsZShmaWxlKSB7XG4gICAgaWYgKGZpbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKCFfLmlzTmlsKHRoaXMuYWxsb3dNYXhTaXplKSAmJiB0aGlzLmFsbG93TWF4U2l6ZSAhPT0gJycpIHtcbiAgICAgICAgaWYgKGZpbGUuc2l6ZSA+IHBhcnNlRmxvYXQodGhpcy5hbGxvd01heFNpemUpICogMTAyNCAqIDEwMjQpIHtcbiAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGBQbGVhc2Ugc2VsZWN0IGZpbGUgbGVzcyB0aGFuICR7dGhpcy5hbGxvd01heFNpemV9TUJgO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuICAgICAgaWYgKFxuICAgICAgICAhXy5pc1VuZGVmaW5lZCh0aGlzLmFjY2VwdCkgJiZcbiAgICAgICAgXy5pc1VuZGVmaW5lZChfLmZpbmQodGhpcy52YWxpZF9leHRlbnNpb25zLCBpdGVtID0+IGl0ZW0udG9Mb3dlckNhc2UoKSA9PT0gdGhpcy5nZXRGaWxlRXh0ZW5zaW9uKGZpbGUpLnRvTG93ZXJDYXNlKCkpKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gJ1BsZWFzZSBzZWxlY3QgYSBmaWxlIHdpdGggdmFsaWQgdHlwZSc7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHRoaXMudXBsb2FkKGZpbGUpO1xuICAgIH1cbiAgfVxuXG4gIHVwbG9hZChmaWxlKSB7XG4gICAgdGhpcy5wcmV2ZW50QWJ1c2UgPSB0cnVlO1xuICAgIHRoaXMucHJvZ3Jlc3NSZWYuc3RhcnQoKTtcbiAgICBjb25zdCBVUExPQURfRElSRUNUSVZFX0hFQURFUlMgPSB0aGlzLmluamVjdG9yLmdldCgnVVBMT0FEX0RJUkVDVElWRV9IRUFERVJTJyk7XG4gICAgY29uc3QgVVBMT0FEX0RJUkVDVElWRV9BUElfVVJMID0gdGhpcy5pbmplY3Rvci5nZXQoJ1VQTE9BRF9ESVJFQ1RJVkVfQVBJX1VSTCcpO1xuXG4gICAgdGhpcy5pc2xvYWQgPSB0cnVlO1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItY29uc3RcbiAgICBsZXQgJHRoaXMgPSB0aGlzO1xuICAgIHRoaXMuaW5Qcm9ncmVzc1sncHJvY2VzcyddID0gdHJ1ZTtcblxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItY29uc3RcbiAgICBsZXQgcGFyYW1zID0ge1xuICAgICAgLy8gZmlsZXM6IGZpbGVcbiAgICAgIHVwbG9hZF9wYXRoOiB0aGlzLnVwbG9hZFBhdGhcbiAgICB9O1xuICAgIHBhcmFtc1t0aGlzLnBhcmFtTmFtZV0gPSBmaWxlO1xuICAgIGNvbnN0IHJlcXVlc3RIZWFkZXJzID0gVVBMT0FEX0RJUkVDVElWRV9IRUFERVJTO1xuICAgIGNvbnN0IHJlcXVlc3RBcGlVcmwgPSBVUExPQURfRElSRUNUSVZFX0FQSV9VUkwgKyB0aGlzLmFwaVVwbG9hZDtcbiAgICB0aGlzLmFwaS51cGxvYWQocGFyYW1zLCByZXF1ZXN0QXBpVXJsLCByZXF1ZXN0SGVhZGVycykuc3Vic2NyaWJlKFxuICAgICAgcmVzcG9uc2UgPT4ge1xuICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5wcm9ncmVzc1JlZi5jb21wbGV0ZSgpO1xuICAgICAgICB0aGlzLmluUHJvZ3Jlc3NbJ3Byb2Nlc3MnXSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm51bWJlcl9maWxlX3VwbG9hZF9zdWNjZXNzKys7XG4gICAgICAgIGlmICghXy5pc05pbCgkdGhpcy5tdWx0aXBsZSkgJiYgJHRoaXMubXVsdGlwbGUgPT09IHRydWUpIHtcbiAgICAgICAgICAkdGhpcy5maWxlTGlzdC5wdXNoKCR0aGlzLnJlc3VsdFRyYW5zZm9ybWVyKHJlc3BvbnNlKSk7XG4gICAgICAgICAgJHRoaXMudmFsdWUgPSAkdGhpcy5maWxlTGlzdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkdGhpcy52YWx1ZSA9ICR0aGlzLnJlc3VsdFRyYW5zZm9ybWVyKHJlc3BvbnNlKTtcbiAgICAgICAgICBpZiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmICghXy5pc05pbCgkdGhpcy53aWR0aCkgfHwgIV8uaXNOaWwoJHRoaXMuaGVpZ2h0KSB8fCAhXy5pc05pbCgkdGhpcy5tYXhXaWR0aCkgfHwgIV8uaXNOaWwoJHRoaXMubWF4SGVpZ2h0KSkge1xuICAgICAgICAgICAgICAkdGhpcy5nZXRJbWFnZURpbWVuc2lvbihyZXNwb25zZS5kYXRhWzBdLmZ1bGxfcGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNsb2FkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcmV2ZW50QWJ1c2UgPSBmYWxzZTtcbiAgICAgICAgLy8gfSwgODAwKTtcbiAgICAgIH0sXG4gICAgICBlcnJvciA9PiB7XG4gICAgICAgIHRoaXMuaXNsb2FkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5Qcm9ncmVzc1sncHJvY2VzcyddID0gZmFsc2U7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlO1xuICAgICAgICB0aGlzLnByb2dyZXNzUmVmLmNvbXBsZXRlKCk7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGdldEltYWdlRGltZW5zaW9uID0gKGltZ1VybCkgPT4ge1xuICAgIGxldCBjaGVjayA9IHRydWU7XG4gICAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgaW1nLnNyYyA9IGltZ1VybDtcbiAgICBpbWcub25sb2FkID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBsb2FkZWRJbWFnZTogYW55ID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgICAgIGNvbnN0IHdpZHRoID0gbG9hZGVkSW1hZ2Uud2lkdGg7XG4gICAgICBjb25zdCBoZWlnaHQgPSBsb2FkZWRJbWFnZS5oZWlnaHQ7XG4gICAgICBpZiAoIV8uaXNOaWwodGhpcy53aWR0aCkpIHtcbiAgICAgICAgaWYgKHdpZHRoICE9PSB0aGlzLndpZHRoKSB7XG4gICAgICAgICAgY2hlY2sgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGAqSW1hZ2Ugd2lkdGggc2hvdWxkIGJlIGVxdWFsIHRvICR7dGhpcy53aWR0aH1weGA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghXy5pc05pbCh0aGlzLm1heFdpZHRoKSkge1xuICAgICAgICBpZiAod2lkdGggPiB0aGlzLm1heFdpZHRoKSB7XG4gICAgICAgICAgY2hlY2sgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGAqSW1hZ2Ugd2lkdGggc2hvdWxkIGJlIHNtYWxsZXIgJHt0aGlzLm1heFdpZHRofXB4YDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCFfLmlzTmlsKHRoaXMuaGVpZ2h0KSkge1xuICAgICAgICBpZiAoaGVpZ2h0ICE9PSB0aGlzLmhlaWdodCkge1xuICAgICAgICAgIGNoZWNrID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBgKkltYWdlIGhlaWdodCBzaG91bGQgYmUgZXF1YWwgdG8gJHt0aGlzLmhlaWdodH1weGA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghXy5pc05pbCh0aGlzLm1heEhlaWdodCkpIHtcbiAgICAgICAgaWYgKGhlaWdodCA+IHRoaXMubWF4SGVpZ2h0KSB7XG4gICAgICAgICAgY2hlY2sgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGAqSW1hZ2UgaGVpZ2h0IHNob3VsZCBiZSBzbWFsbGVyICR7dGhpcy5tYXhIZWlnaHR9cHhgO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIWNoZWNrKSB7XG4gICAgICAgIHRoaXMud2FybmluZyA9IG51bGw7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGRlbGV0ZUl0ZW0oaXRlbSkge1xuICAgIGlmICh0aGlzLm11bHRpcGxlID09PSB0cnVlKSB7XG4gICAgICB0aGlzLmZpbGVMaXN0LnNwbGljZSh0aGlzLmZpbGVMaXN0LmluZGV4T2YoaXRlbSksIDEpO1xuICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuZmlsZUxpc3Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGlzSW5jbHVkZSh2YWx1ZSwgYXJyKSB7XG4gICAgY29uc3QgYWNjZXB0cyA9IHZhbHVlLnNwbGl0KCd8Jyk7XG4gICAgbGV0IHJlc3VsdCA9IHRydWU7XG4gICAgXy5mb3JFYWNoKGFjY2VwdHMsIGZ1bmN0aW9uIChpKSB7XG4gICAgICBpZiAoIV8uZmluZChhcnIsIGl0ZW0gPT4gaXRlbSA9PT0gaSkpIHtcbiAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGdldEljb24oYWNjZXB0cykge1xuICAgIGNvbnN0ICR0aGlzID0gdGhpcztcbiAgICBhY2NlcHRzID0gYWNjZXB0cy5zcGxpdCgnfCcpO1xuICAgIGxldCByZXN1bHQgPSAnZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUnO1xuICAgIF8uZm9yRWFjaChhY2NlcHRzLCBmdW5jdGlvbiAoaSkge1xuICAgICAgaWYgKF8uZmluZCgkdGhpcy5kb2N1bWVudEZvcm1hdHMsIGl0ZW0gPT4gaXRlbSA9PT0gaSkpIHtcbiAgICAgICAgcmVzdWx0ID0gJ2ZhLWZpbGUtdGV4dC1vJztcbiAgICAgIH1cbiAgICAgIGlmIChfLmZpbmQoJHRoaXMudmlkZW9Gb3JtYXRzLCBpdGVtID0+IGl0ZW0gPT09IGkpKSB7XG4gICAgICAgIHJlc3VsdCA9ICdmYS1maWxlLXZpZGVvLW8nO1xuICAgICAgfVxuICAgICAgaWYgKF8uZmluZCgkdGhpcy5zb3VuZEZvcm1hdHMsIGl0ZW0gPT4gaXRlbSA9PT0gaSkpIHtcbiAgICAgICAgcmVzdWx0ID0gJ2ZhLWZpbGUtYXVkaW8tbyc7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIG9rb2soKSB7XG4gICAgdGhpcy5kYXRhRnVuY3Rpb24oKTtcbiAgfVxufVxuIl19